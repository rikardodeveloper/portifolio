/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
import { Component, Input, Optional, Self, ViewChild, ElementRef } from '@angular/core';
import { NgForm, FormGroupDirective, NgControl } from '@angular/forms';
import { ErrorStateMatcher, mixinErrorState } from '@angular/material/core';
import { MatFormFieldControl } from '@angular/material/form-field';
import { UploadFile } from './upload-file';
/** @type {?} */
let nextUniqueId = 0;
export class BaseMatFileUploadComponent {
    /**
     * @param {?} _defaultErrorStateMatcher
     * @param {?} _parentForm
     * @param {?} _parentFormGroup
     * @param {?} ngControl
     */
    constructor(_defaultErrorStateMatcher, _parentForm, _parentFormGroup, ngControl) {
        this._defaultErrorStateMatcher = _defaultErrorStateMatcher;
        this._parentForm = _parentForm;
        this._parentFormGroup = _parentFormGroup;
        this.ngControl = ngControl;
    }
}
if (false) {
    /** @type {?} */
    BaseMatFileUploadComponent.prototype._defaultErrorStateMatcher;
    /** @type {?} */
    BaseMatFileUploadComponent.prototype._parentForm;
    /** @type {?} */
    BaseMatFileUploadComponent.prototype._parentFormGroup;
    /** @type {?} */
    BaseMatFileUploadComponent.prototype.ngControl;
}
/** @type {?} */
export const _BaseMatFileUploadComponentMixin = mixinErrorState(BaseMatFileUploadComponent);
export class MatFileUploadComponent extends _BaseMatFileUploadComponentMixin {
    /**
     * @param {?} defaultErrorStateMatcher
     * @param {?} parentForm
     * @param {?} parentFormGroup
     * @param {?} ngControl
     */
    constructor(defaultErrorStateMatcher, parentForm, parentFormGroup, ngControl) {
        super(defaultErrorStateMatcher, parentForm, parentFormGroup, ngControl);
        this.ngControl = ngControl;
        this.required = false;
        this.multiple = false;
        this.preview = false;
        this.previewPosition = 'bottom';
        this.dense = false;
        this.selectedText = defaultSelectedText;
        this.visibleValue = '';
        this.shouldLabelFloat = true;
        this._files = [];
        this._uid = `wa-mat-file-upload-${nextUniqueId++}`;
        this.onTouched = () => { };
        this._onChange = (_) => { };
        if (this.ngControl !== null) {
            this.ngControl.valueAccessor = this;
        }
    }
    /**
     * @return {?}
     */
    get value() {
        return this._value;
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set value(value) { }
    /**
     * @return {?}
     */
    get disabled() {
        if (typeof this._disabled !== 'undefined') {
            return this._disabled;
        }
        if (this.ngControl && this.ngControl.disabled !== null) {
            return this.ngControl.disabled;
        }
        return false;
    }
    /**
     * @param {?} disabled
     * @return {?}
     */
    set disabled(disabled) {
        this._disabled = disabled;
    }
    /**
     * @return {?}
     */
    get id() {
        return this._id;
    }
    /**
     * @param {?} id
     * @return {?}
     */
    set id(id) {
        this._id = id || this._uid;
    }
    /**
     * @return {?}
     */
    get files() {
        return this._files;
    }
    /**
     * @return {?}
     */
    get empty() {
        return typeof this._value === 'undefined';
    }
    /**
     * @return {?}
     */
    get focused() {
        return false;
    }
    /**
     * @return {?}
     */
    openDialog() {
        if (this.fileUpload) {
            this.fileUpload.nativeElement.click();
        }
    }
    /**
     * @return {?}
     */
    clearFiles() {
        this._value = [];
        this._files = [];
        this.recalculate();
    }
    /**
     * @param {?} file
     * @return {?}
     */
    removeFile(file) {
        this._value.splice(this._value.indexOf(file.file), 1);
        this._files.splice(this._files.indexOf(file), 1);
        this.recalculate();
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.visibleValue = this.selectedText(this._files);
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        this.stateChanges.complete();
    }
    /**
     * @param {?} files
     * @return {?}
     */
    onChange(files) {
        this._value = [];
        this._files = [];
        for (let i = 0; i < files.length; i++) {
            this._value.push(files[i]);
            this._files.push(new UploadFile(files[i]));
        }
        this.recalculate();
    }
    /**
     * @param {?} value
     * @return {?}
     */
    writeValue(value) { }
    /**
     * @param {?} fn
     * @return {?}
     */
    registerOnChange(fn) {
        this._onChange = fn;
    }
    /**
     * @param {?} fn
     * @return {?}
     */
    registerOnTouched(fn) {
        this.onTouched = fn;
    }
    /**
     * @param {?} isDisabled
     * @return {?}
     */
    setDisabledState(isDisabled) {
        this.disabled = isDisabled;
    }
    /**
     * @return {?}
     */
    onContainerClick() { }
    /**
     * @return {?}
     */
    focus() { }
    /**
     * @return {?}
     */
    setDescribedByIds() { }
    /**
     * @return {?}
     */
    recalculate() {
        this.fileUpload.nativeElement.value = '';
        this.visibleValue = this.selectedText(this._files);
        this._onChange(this._value);
        this.onTouched();
        this.updateErrorState();
    }
}
MatFileUploadComponent.decorators = [
    { type: Component, args: [{
                exportAs: 'waMatFileUpload',
                selector: 'wa-mat-file-upload',
                template: "<ng-template #previewContainer>\n\t<mat-list *ngIf=\"preview && files.length\" [attr.dense]=\"dense ? 'dense' : null\">\n\t\t<ng-container *ngFor=\"let file of files; let isLast = last;\">\n\t\t\t<mat-list-item>\n\t\t\t\t<img *ngIf=\"file.supportsImagePreview(); else listItemIcon\" matListAvatar [src]=\"file.getImageSource() | async\">\n\t\t\t\t<ng-template #listItemIcon>\n\t\t\t\t\t<mat-icon mat-list-icon>{{ file.icon }}</mat-icon>\n\t\t\t\t</ng-template>\n\n\t\t\t\t<h3 matLine>{{ file.file.name }}</h3>\n\n\t\t\t\t<mat-progress-bar *ngIf=\"file.progress\" matLine mode=\"determinate\" [value]=\"file.progress\"></mat-progress-bar>\n\n\t\t\t\t<button *ngIf=\"!disabled && file.progress === 0\" mat-icon-button (click)=\"removeFile(file)\" type=\"button\">\n\t\t\t\t\t<mat-icon>close</mat-icon>\n\t\t\t\t</button>\n\t\t\t</mat-list-item>\n\t\t\t<mat-divider *ngIf=\"!isLast\"></mat-divider>\n\t\t</ng-container>\n\t</mat-list>\n</ng-template>\n\n<ng-container *ngIf=\"previewPosition === 'top'\">\n\t<ng-container *ngTemplateOutlet=\"previewContainer\"></ng-container>\n</ng-container>\n\n<input #fileUpload type=\"file\" (change)=\"onChange($event.target.files)\" [multiple]=\"multiple\" style=\"display: none;\">\n\n<div>\n\t<button mat-raised-button (click)=\"openDialog()\" [color]=\"color\" [disabled]=\"disabled\" type=\"button\"><ng-content></ng-content></button>\n\t<span [ngClass]=\"{'mat-caption': dense}\" style=\"padding-left: 10px;\">\n\t\t{{ visibleValue }}\n\t\t<button *ngIf=\"!disabled && files.length\" mat-icon-button (click)=\"clearFiles()\" type=\"button\">\n\t\t\t<mat-icon>close</mat-icon>\n\t\t</button>\n\t</span>\n</div>\n\n<ng-container *ngIf=\"previewPosition === 'bottom'\">\n\t<ng-container *ngTemplateOutlet=\"previewContainer\"></ng-container>\n</ng-container>\n",
                providers: [
                    {
                        provide: MatFormFieldControl,
                        useExisting: MatFileUploadComponent,
                    },
                ]
            }] }
];
/** @nocollapse */
MatFileUploadComponent.ctorParameters = () => [
    { type: ErrorStateMatcher },
    { type: NgForm, decorators: [{ type: Optional }] },
    { type: FormGroupDirective, decorators: [{ type: Optional }] },
    { type: NgControl, decorators: [{ type: Self }, { type: Optional }] }
];
MatFileUploadComponent.propDecorators = {
    placeholder: [{ type: Input }],
    required: [{ type: Input }],
    multiple: [{ type: Input }],
    color: [{ type: Input }],
    preview: [{ type: Input }],
    previewPosition: [{ type: Input }],
    dense: [{ type: Input }],
    selectedText: [{ type: Input }],
    fileUpload: [{ type: ViewChild, args: ['fileUpload',] }],
    value: [{ type: Input }],
    disabled: [{ type: Input }],
    id: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    MatFileUploadComponent.prototype.placeholder;
    /** @type {?} */
    MatFileUploadComponent.prototype.required;
    /** @type {?} */
    MatFileUploadComponent.prototype.multiple;
    /** @type {?} */
    MatFileUploadComponent.prototype.color;
    /** @type {?} */
    MatFileUploadComponent.prototype.preview;
    /** @type {?} */
    MatFileUploadComponent.prototype.previewPosition;
    /** @type {?} */
    MatFileUploadComponent.prototype.dense;
    /** @type {?} */
    MatFileUploadComponent.prototype.selectedText;
    /** @type {?} */
    MatFileUploadComponent.prototype.fileUpload;
    /** @type {?} */
    MatFileUploadComponent.prototype.visibleValue;
    /** @type {?} */
    MatFileUploadComponent.prototype.shouldLabelFloat;
    /** @type {?} */
    MatFileUploadComponent.prototype._value;
    /** @type {?} */
    MatFileUploadComponent.prototype._files;
    /** @type {?} */
    MatFileUploadComponent.prototype._disabled;
    /** @type {?} */
    MatFileUploadComponent.prototype._id;
    /** @type {?} */
    MatFileUploadComponent.prototype._uid;
    /** @type {?} */
    MatFileUploadComponent.prototype.onTouched;
    /** @type {?} */
    MatFileUploadComponent.prototype._onChange;
    /** @type {?} */
    MatFileUploadComponent.prototype.ngControl;
}
/**
 * @param {?} files
 * @return {?}
 */
function defaultSelectedText(files) {
    if (files.length === 0) {
        return '';
    }
    if (files.length === 1) {
        return files[0].file.name;
    }
    return files.length + ' Files selected';
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWF0LWZpbGUtdXBsb2FkLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0B3ZWJhY2FkL25nLW1hdC1maWxlLXVwbG9hZC8iLCJzb3VyY2VzIjpbIm1hdC1maWxlLXVwbG9hZC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBQyxTQUFTLEVBQUUsS0FBSyxFQUFFLFFBQVEsRUFBRSxJQUFJLEVBQXFCLFNBQVMsRUFBRSxVQUFVLEVBQUMsTUFBTSxlQUFlLENBQUM7QUFDekcsT0FBTyxFQUF1QixNQUFNLEVBQUUsa0JBQWtCLEVBQUUsU0FBUyxFQUFDLE1BQU0sZ0JBQWdCLENBQUM7QUFDM0YsT0FBTyxFQUFDLGlCQUFpQixFQUF1QixlQUFlLEVBQUMsTUFBTSx3QkFBd0IsQ0FBQztBQUMvRixPQUFPLEVBQUMsbUJBQW1CLEVBQUMsTUFBTSw4QkFBOEIsQ0FBQztBQUVqRSxPQUFPLEVBQUMsVUFBVSxFQUFDLE1BQU0sZUFBZSxDQUFDOztBQUd6QyxJQUFJLFlBQVksR0FBVyxDQUFDLENBQUM7QUFHN0IsTUFBTTs7Ozs7OztJQUlMLFlBQ1EsMkJBQ0EsYUFDQSxrQkFDQTtRQUhBLDhCQUF5QixHQUF6Qix5QkFBeUI7UUFDekIsZ0JBQVcsR0FBWCxXQUFXO1FBQ1gscUJBQWdCLEdBQWhCLGdCQUFnQjtRQUNoQixjQUFTLEdBQVQsU0FBUztLQUNiO0NBRUo7Ozs7Ozs7Ozs7OztBQUdELGFBQWEsZ0NBQWdDLEdBQUcsZUFBZSxDQUFDLDBCQUEwQixDQUFDLENBQUM7QUFjNUYsTUFBTSw2QkFBOEIsU0FBUSxnQ0FBZ0M7Ozs7Ozs7SUFrRDNFLFlBQ0Msd0JBQTJDLEVBQy9CLFVBQWtCLEVBQ2xCLGVBQW1DLEVBQ1gsU0FBb0I7UUFFeEQsS0FBSyxDQUFDLHdCQUF3QixFQUFFLFVBQVUsRUFBRSxlQUFlLEVBQUUsU0FBUyxDQUFDLENBQUM7UUFGcEMsY0FBUyxHQUFULFNBQVMsQ0FBVzt3QkExQzlCLEtBQUs7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O1lBMUYyQixrQkFBa0IsdUJBMkZyRCxRQUFRO1lBM0YrQyxTQUFTLHVCQTRGaEUsSUFBSSxZQUFJLFFBQVE7OzswQkE5Q2pCLEtBQUs7dUJBR0wsS0FBSzt1QkFHTCxLQUFLO29CQUdMLEtBQUs7c0JBR0wsS0FBSzs4QkFHTCxLQUFLO29CQUdMLEtBQUs7MkJBR0wsS0FBSzt5QkFHTCxTQUFTLFNBQUMsWUFBWTtvQkFnQ3RCLEtBQUs7dUJBU0wsS0FBSztpQkFvQkwsS0FBSzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQWlJUCw2QkFBNkIsS0FBd0I7SUFFcEQsSUFBSSxLQUFLLENBQUMsTUFBTSxLQUFLLENBQUMsRUFBRTtRQUN2QixPQUFPLEVBQUUsQ0FBQztLQUNWO0lBRUQsSUFBSSxLQUFLLENBQUMsTUFBTSxLQUFLLENBQUMsRUFBRTtRQUN2QixPQUFPLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDO0tBQzFCO0lBRUQsT0FBTyxLQUFLLENBQUMsTUFBTSxHQUFHLGlCQUFpQixDQUFDO0NBQ3hDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtDb21wb25lbnQsIElucHV0LCBPcHRpb25hbCwgU2VsZiwgT25Jbml0LCBPbkRlc3Ryb3ksIFZpZXdDaGlsZCwgRWxlbWVudFJlZn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge0NvbnRyb2xWYWx1ZUFjY2Vzc29yLCBOZ0Zvcm0sIEZvcm1Hcm91cERpcmVjdGl2ZSwgTmdDb250cm9sfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5pbXBvcnQge0Vycm9yU3RhdGVNYXRjaGVyLCBDYW5VcGRhdGVFcnJvclN0YXRlLCBtaXhpbkVycm9yU3RhdGV9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsL2NvcmUnO1xuaW1wb3J0IHtNYXRGb3JtRmllbGRDb250cm9sfSBmcm9tICdAYW5ndWxhci9tYXRlcmlhbC9mb3JtLWZpZWxkJztcblxuaW1wb3J0IHtVcGxvYWRGaWxlfSBmcm9tICcuL3VwbG9hZC1maWxlJztcblxuXG5sZXQgbmV4dFVuaXF1ZUlkOiBudW1iZXIgPSAwO1xuXG5cbmV4cG9ydCBjbGFzcyBCYXNlTWF0RmlsZVVwbG9hZENvbXBvbmVudFxue1xuXG5cblx0Y29uc3RydWN0b3IoXG5cdFx0cHVibGljIF9kZWZhdWx0RXJyb3JTdGF0ZU1hdGNoZXI6IEVycm9yU3RhdGVNYXRjaGVyLFxuXHRcdHB1YmxpYyBfcGFyZW50Rm9ybTogTmdGb3JtLFxuXHRcdHB1YmxpYyBfcGFyZW50Rm9ybUdyb3VwOiBGb3JtR3JvdXBEaXJlY3RpdmUsXG5cdFx0cHVibGljIG5nQ29udHJvbDogTmdDb250cm9sLFxuXHQpIHt9XG5cbn1cblxuXG5leHBvcnQgY29uc3QgX0Jhc2VNYXRGaWxlVXBsb2FkQ29tcG9uZW50TWl4aW4gPSBtaXhpbkVycm9yU3RhdGUoQmFzZU1hdEZpbGVVcGxvYWRDb21wb25lbnQpO1xuXG5cbkBDb21wb25lbnQoe1xuXHRleHBvcnRBczogJ3dhTWF0RmlsZVVwbG9hZCcsXG5cdHNlbGVjdG9yOiAnd2EtbWF0LWZpbGUtdXBsb2FkJyxcblx0dGVtcGxhdGVVcmw6ICcuL21hdC1maWxlLXVwbG9hZC5jb21wb25lbnQuaHRtbCcsXG5cdHByb3ZpZGVyczogW1xuXHRcdHtcblx0XHRcdHByb3ZpZGU6IE1hdEZvcm1GaWVsZENvbnRyb2wsXG5cdFx0XHR1c2VFeGlzdGluZzogTWF0RmlsZVVwbG9hZENvbXBvbmVudCxcblx0XHR9LFxuXHRdLFxufSlcbmV4cG9ydCBjbGFzcyBNYXRGaWxlVXBsb2FkQ29tcG9uZW50IGV4dGVuZHMgX0Jhc2VNYXRGaWxlVXBsb2FkQ29tcG9uZW50TWl4aW4gaW1wbGVtZW50c1xuXHRPbkluaXQsXG5cdE9uRGVzdHJveSxcblx0Q29udHJvbFZhbHVlQWNjZXNzb3IsXG5cdE1hdEZvcm1GaWVsZENvbnRyb2w8QXJyYXk8RmlsZT4+XG57XG5cblxuXHRASW5wdXQoKVxuXHRwdWJsaWMgcGxhY2Vob2xkZXI6IHN0cmluZztcblxuXHRASW5wdXQoKVxuXHRwdWJsaWMgcmVxdWlyZWQ6IGJvb2xlYW4gPSBmYWxzZTtcblxuXHRASW5wdXQoKVxuXHRwdWJsaWMgbXVsdGlwbGU6IGJvb2xlYW4gPSBmYWxzZTtcblxuXHRASW5wdXQoKVxuXHRwdWJsaWMgY29sb3I6IHN0cmluZ3x1bmRlZmluZWQ7XG5cblx0QElucHV0KClcblx0cHVibGljIHByZXZpZXc6IGJvb2xlYW4gPSBmYWxzZTtcblxuXHRASW5wdXQoKVxuXHRwdWJsaWMgcHJldmlld1Bvc2l0aW9uOiAndG9wJyB8ICdib3R0b20nID0gJ2JvdHRvbSc7XG5cblx0QElucHV0KClcblx0cHVibGljIGRlbnNlOiBib29sZWFuID0gZmFsc2U7XG5cblx0QElucHV0KClcblx0cHVibGljIHNlbGVjdGVkVGV4dDogKGZpbGVzOiBBcnJheTxVcGxvYWRGaWxlPikgPT4gc3RyaW5nID0gZGVmYXVsdFNlbGVjdGVkVGV4dDtcblxuXHRAVmlld0NoaWxkKCdmaWxlVXBsb2FkJylcblx0cHVibGljIGZpbGVVcGxvYWQ6IEVsZW1lbnRSZWY7XG5cblx0cHVibGljIHZpc2libGVWYWx1ZTogc3RyaW5nID0gJyc7XG5cblx0cHVibGljIHNob3VsZExhYmVsRmxvYXQ6IGJvb2xlYW4gPSB0cnVlO1xuXG5cdHByaXZhdGUgX3ZhbHVlOiBBcnJheTxGaWxlPjtcblxuXHRwcml2YXRlIF9maWxlczogQXJyYXk8VXBsb2FkRmlsZT4gPSBbXTtcblxuXHRwcml2YXRlIF9kaXNhYmxlZDogYm9vbGVhbjtcblxuXHRwcml2YXRlIF9pZDogc3RyaW5nO1xuXG5cdHByaXZhdGUgX3VpZDogc3RyaW5nID0gYHdhLW1hdC1maWxlLXVwbG9hZC0ke25leHRVbmlxdWVJZCsrfWA7XG5cblxuXHRjb25zdHJ1Y3Rvcihcblx0XHRkZWZhdWx0RXJyb3JTdGF0ZU1hdGNoZXI6IEVycm9yU3RhdGVNYXRjaGVyLFxuXHRcdEBPcHRpb25hbCgpIHBhcmVudEZvcm06IE5nRm9ybSxcblx0XHRAT3B0aW9uYWwoKSBwYXJlbnRGb3JtR3JvdXA6IEZvcm1Hcm91cERpcmVjdGl2ZSxcblx0XHRAU2VsZigpIEBPcHRpb25hbCgpIHB1YmxpYyByZWFkb25seSBuZ0NvbnRyb2w6IE5nQ29udHJvbCxcblx0KSB7XG5cdFx0c3VwZXIoZGVmYXVsdEVycm9yU3RhdGVNYXRjaGVyLCBwYXJlbnRGb3JtLCBwYXJlbnRGb3JtR3JvdXAsIG5nQ29udHJvbCk7XG5cblx0XHRpZiAodGhpcy5uZ0NvbnRyb2wgIT09IG51bGwpIHtcblx0XHRcdHRoaXMubmdDb250cm9sLnZhbHVlQWNjZXNzb3IgPSB0aGlzO1xuXHRcdH1cblx0fVxuXG5cblx0QElucHV0KClcblx0Z2V0IHZhbHVlKCk6IEFycmF5PEZpbGU+XG5cdHtcblx0XHRyZXR1cm4gdGhpcy5fdmFsdWU7XG5cdH1cblxuXHRzZXQgdmFsdWUodmFsdWU6IEFycmF5PEZpbGU+KSB7fVxuXG5cblx0QElucHV0KClcblx0Z2V0IGRpc2FibGVkKCk6IGJvb2xlYW5cblx0e1xuXHRcdGlmICh0eXBlb2YgdGhpcy5fZGlzYWJsZWQgIT09ICd1bmRlZmluZWQnKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5fZGlzYWJsZWQ7XG5cdFx0fVxuXG5cdFx0aWYgKHRoaXMubmdDb250cm9sICYmIHRoaXMubmdDb250cm9sLmRpc2FibGVkICE9PSBudWxsKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5uZ0NvbnRyb2wuZGlzYWJsZWQ7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG5cblx0c2V0IGRpc2FibGVkKGRpc2FibGVkOiBib29sZWFuKVxuXHR7XG5cdFx0dGhpcy5fZGlzYWJsZWQgPSBkaXNhYmxlZDtcblx0fVxuXG5cblx0QElucHV0KClcblx0Z2V0IGlkKCk6IHN0cmluZ1xuXHR7XG5cdFx0cmV0dXJuIHRoaXMuX2lkO1xuXHR9XG5cblx0c2V0IGlkKGlkOiBzdHJpbmcpXG5cdHtcblx0XHR0aGlzLl9pZCA9IGlkIHx8IHRoaXMuX3VpZDtcblx0fVxuXG5cblx0Z2V0IGZpbGVzKCk6IEFycmF5PFVwbG9hZEZpbGU+XG5cdHtcblx0XHRyZXR1cm4gdGhpcy5fZmlsZXM7XG5cdH1cblxuXG5cdGdldCBlbXB0eSgpOiBib29sZWFuXG5cdHtcblx0XHRyZXR1cm4gdHlwZW9mIHRoaXMuX3ZhbHVlID09PSAndW5kZWZpbmVkJztcblx0fVxuXG5cblx0Z2V0IGZvY3VzZWQoKTogYm9vbGVhblxuXHR7XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG5cblxuXHRwdWJsaWMgb3BlbkRpYWxvZygpOiB2b2lkXG5cdHtcblx0XHRpZiAodGhpcy5maWxlVXBsb2FkKSB7XG5cdFx0XHR0aGlzLmZpbGVVcGxvYWQubmF0aXZlRWxlbWVudC5jbGljaygpO1xuXHRcdH1cblx0fVxuXG5cblx0cHVibGljIGNsZWFyRmlsZXMoKTogdm9pZFxuXHR7XG5cdFx0dGhpcy5fdmFsdWUgPSBbXTtcblx0XHR0aGlzLl9maWxlcyA9IFtdO1xuXHRcdHRoaXMucmVjYWxjdWxhdGUoKTtcblx0fVxuXG5cblx0cHVibGljIHJlbW92ZUZpbGUoZmlsZTogVXBsb2FkRmlsZSk6IHZvaWRcblx0e1xuXHRcdHRoaXMuX3ZhbHVlLnNwbGljZSh0aGlzLl92YWx1ZS5pbmRleE9mKGZpbGUuZmlsZSksIDEpO1xuXHRcdHRoaXMuX2ZpbGVzLnNwbGljZSh0aGlzLl9maWxlcy5pbmRleE9mKGZpbGUpLCAxKTtcblx0XHR0aGlzLnJlY2FsY3VsYXRlKCk7XG5cdH1cblxuXG5cdHB1YmxpYyBuZ09uSW5pdCgpOiB2b2lkXG5cdHtcblx0XHR0aGlzLnZpc2libGVWYWx1ZSA9IHRoaXMuc2VsZWN0ZWRUZXh0KHRoaXMuX2ZpbGVzKTtcblx0fVxuXG5cblx0cHVibGljIG5nT25EZXN0cm95KCk6IHZvaWRcblx0e1xuXHRcdHRoaXMuc3RhdGVDaGFuZ2VzLmNvbXBsZXRlKCk7XG5cdH1cblxuXG5cdHB1YmxpYyBvblRvdWNoZWQgPSAoKSA9PiB7fTtcblxuXG5cdHB1YmxpYyBvbkNoYW5nZShmaWxlczogRmlsZUxpc3QpOiB2b2lkXG5cdHtcblx0XHR0aGlzLl92YWx1ZSA9IFtdO1xuXHRcdHRoaXMuX2ZpbGVzID0gW107XG5cblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGZpbGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHR0aGlzLl92YWx1ZS5wdXNoKGZpbGVzW2ldKTtcblx0XHRcdHRoaXMuX2ZpbGVzLnB1c2gobmV3IFVwbG9hZEZpbGUoZmlsZXNbaV0pKTtcblx0XHR9XG5cblx0XHR0aGlzLnJlY2FsY3VsYXRlKCk7XG5cdH1cblxuXG5cdHB1YmxpYyB3cml0ZVZhbHVlKHZhbHVlOiBhbnkpOiB2b2lkIHt9XG5cblxuXHRwdWJsaWMgcmVnaXN0ZXJPbkNoYW5nZShmbjogKF86IGFueSkgPT4gdm9pZCk6IHZvaWRcblx0e1xuXHRcdHRoaXMuX29uQ2hhbmdlID0gZm47XG5cdH1cblxuXG5cdHB1YmxpYyByZWdpc3Rlck9uVG91Y2hlZChmbjogKCkgPT4gdm9pZCk6IHZvaWRcblx0e1xuXHRcdHRoaXMub25Ub3VjaGVkID0gZm47XG5cdH1cblxuXG5cdHB1YmxpYyBzZXREaXNhYmxlZFN0YXRlKGlzRGlzYWJsZWQ6IGJvb2xlYW4pOiB2b2lkXG5cdHtcblx0XHR0aGlzLmRpc2FibGVkID0gaXNEaXNhYmxlZDtcblx0fVxuXG5cblx0cHVibGljIG9uQ29udGFpbmVyQ2xpY2soKTogdm9pZCB7fVxuXG5cblx0cHVibGljIGZvY3VzKCk6IHZvaWQge31cblxuXG5cdHB1YmxpYyBzZXREZXNjcmliZWRCeUlkcygpOiB2b2lkIHt9XG5cblxuXHRwcml2YXRlIF9vbkNoYW5nZSA9IChfOiBhbnkpID0+IHt9O1xuXG5cblx0cHJpdmF0ZSByZWNhbGN1bGF0ZSgpOiB2b2lkXG5cdHtcblx0XHR0aGlzLmZpbGVVcGxvYWQubmF0aXZlRWxlbWVudC52YWx1ZSA9ICcnO1xuXHRcdHRoaXMudmlzaWJsZVZhbHVlID0gdGhpcy5zZWxlY3RlZFRleHQodGhpcy5fZmlsZXMpO1xuXG5cdFx0dGhpcy5fb25DaGFuZ2UodGhpcy5fdmFsdWUpO1xuXHRcdHRoaXMub25Ub3VjaGVkKCk7XG5cdFx0dGhpcy51cGRhdGVFcnJvclN0YXRlKCk7XG5cdH1cblxufVxuXG5cbmZ1bmN0aW9uIGRlZmF1bHRTZWxlY3RlZFRleHQoZmlsZXM6IEFycmF5PFVwbG9hZEZpbGU+KTogc3RyaW5nXG57XG5cdGlmIChmaWxlcy5sZW5ndGggPT09IDApIHtcblx0XHRyZXR1cm4gJyc7XG5cdH1cblxuXHRpZiAoZmlsZXMubGVuZ3RoID09PSAxKSB7XG5cdFx0cmV0dXJuIGZpbGVzWzBdLmZpbGUubmFtZTtcblx0fVxuXG5cdHJldHVybiBmaWxlcy5sZW5ndGggKyAnIEZpbGVzIHNlbGVjdGVkJztcbn1cbiJdfQ==