(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('@webacad/observable-file-reader'), require('@angular/core'), require('@angular/forms'), require('@angular/material/core'), require('@angular/material/form-field'), require('@angular/common'), require('@angular/material/button'), require('@angular/material/divider'), require('@angular/material/list'), require('@angular/material/progress-bar'), require('@angular/material/icon')) :
    typeof define === 'function' && define.amd ? define('@webacad/ng-mat-file-upload', ['exports', '@webacad/observable-file-reader', '@angular/core', '@angular/forms', '@angular/material/core', '@angular/material/form-field', '@angular/common', '@angular/material/button', '@angular/material/divider', '@angular/material/list', '@angular/material/progress-bar', '@angular/material/icon'], factory) :
    (factory((global.webacad = global.webacad || {}, global.webacad['ng-mat-file-upload'] = {}),global.observableFileReader,global.ng.core,global.ng.forms,global.ng.material.core,global.ng.material['form-field'],global.ng.common,global.ng.material.button,global.ng.material.divider,global.ng.material.list,global.ng.material['progress-bar'],global.ng.material.icon));
}(this, (function (exports,observableFileReader,core,forms,core$1,formField,common,button,divider,list,progressBar,icon) { 'use strict';

    /*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
    /* global Reflect, Promise */
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b)
                if (b.hasOwnProperty(p))
                    d[p] = b[p]; };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    /** @type {?} */
    var imageMimeTypes = [
        'image/gif', 'image/png', 'image/jpeg',
    ];
    var UploadFile = /** @class */ (function () {
        function UploadFile(file, _progress) {
            if (_progress === void 0) {
                _progress = 0;
            }
            this.file = file;
            this._progress = _progress;
            this.icon = 'cloud_upload';
        }
        Object.defineProperty(UploadFile.prototype, "progress", {
            get: /**
             * @return {?}
             */ function () {
                return this._progress;
            },
            set: /**
             * @param {?} progress
             * @return {?}
             */ function (progress) {
                this._progress = progress;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @return {?}
         */
        UploadFile.prototype.supportsImagePreview = /**
         * @return {?}
         */
            function () {
                return imageMimeTypes.indexOf(this.file.type) >= 0;
            };
        /**
         * @return {?}
         */
        UploadFile.prototype.getImageSource = /**
         * @return {?}
         */
            function () {
                if (typeof this.imageSource !== 'undefined') {
                    return this.imageSource;
                }
                return this.imageSource = observableFileReader.readFileAsDataURL(this.file);
            };
        /**
         * @param {?} add
         * @return {?}
         */
        UploadFile.prototype.increaseProgress = /**
         * @param {?} add
         * @return {?}
         */
            function (add) {
                this.progress += add;
            };
        return UploadFile;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    /** @type {?} */
    var nextUniqueId = 0;
    var BaseMatFileUploadComponent = /** @class */ (function () {
        function BaseMatFileUploadComponent(_defaultErrorStateMatcher, _parentForm, _parentFormGroup, ngControl) {
            this._defaultErrorStateMatcher = _defaultErrorStateMatcher;
            this._parentForm = _parentForm;
            this._parentFormGroup = _parentFormGroup;
            this.ngControl = ngControl;
        }
        return BaseMatFileUploadComponent;
    }());
    /** @type {?} */
    var _BaseMatFileUploadComponentMixin = core$1.mixinErrorState(BaseMatFileUploadComponent);
    var MatFileUploadComponent = /** @class */ (function (_super) {
        __extends(MatFileUploadComponent, _super);
        function MatFileUploadComponent(defaultErrorStateMatcher, parentForm, parentFormGroup, ngControl) {
            var _this = _super.call(this, defaultErrorStateMatcher, parentForm, parentFormGroup, ngControl) || this;
            _this.ngControl = ngControl;
            _this.required = false;
            _this.multiple = false;
            _this.preview = false;
            _this.previewPosition = 'bottom';
            _this.dense = false;
            _this.selectedText = defaultSelectedText;
            _this.visibleValue = '';
            _this.shouldLabelFloat = true;
            _this._files = [];
            _this._uid = "wa-mat-file-upload-" + nextUniqueId++;
            _this.onTouched = function () { };
            _this._onChange = function (_) { };
            if (_this.ngControl !== null) {
                _this.ngControl.valueAccessor = _this;
            }
            return _this;
        }
        Object.defineProperty(MatFileUploadComponent.prototype, "value", {
            get: /**
             * @return {?}
             */ function () {
                return this._value;
            },
            set: /**
             * @param {?} value
             * @return {?}
             */ function (value) { },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(MatFileUploadComponent.prototype, "disabled", {
            get: /**
             * @return {?}
             */ function () {
                if (typeof this._disabled !== 'undefined') {
                    return this._disabled;
                }
                if (this.ngControl && this.ngControl.disabled !== null) {
                    return this.ngControl.disabled;
                }
                return false;
            },
            set: /**
             * @param {?} disabled
             * @return {?}
             */ function (disabled) {
                this._disabled = disabled;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(MatFileUploadComponent.prototype, "id", {
            get: /**
             * @return {?}
             */ function () {
                return this._id;
            },
            set: /**
             * @param {?} id
             * @return {?}
             */ function (id) {
                this._id = id || this._uid;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(MatFileUploadComponent.prototype, "files", {
            get: /**
             * @return {?}
             */ function () {
                return this._files;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(MatFileUploadComponent.prototype, "empty", {
            get: /**
             * @return {?}
             */ function () {
                return typeof this._value === 'undefined';
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(MatFileUploadComponent.prototype, "focused", {
            get: /**
             * @return {?}
             */ function () {
                return false;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @return {?}
         */
        MatFileUploadComponent.prototype.openDialog = /**
         * @return {?}
         */
            function () {
                if (this.fileUpload) {
                    this.fileUpload.nativeElement.click();
                }
            };
        /**
         * @return {?}
         */
        MatFileUploadComponent.prototype.clearFiles = /**
         * @return {?}
         */
            function () {
                this._value = [];
                this._files = [];
                this.recalculate();
            };
        /**
         * @param {?} file
         * @return {?}
         */
        MatFileUploadComponent.prototype.removeFile = /**
         * @param {?} file
         * @return {?}
         */
            function (file) {
                this._value.splice(this._value.indexOf(file.file), 1);
                this._files.splice(this._files.indexOf(file), 1);
                this.recalculate();
            };
        /**
         * @return {?}
         */
        MatFileUploadComponent.prototype.ngOnInit = /**
         * @return {?}
         */
            function () {
                this.visibleValue = this.selectedText(this._files);
            };
        /**
         * @return {?}
         */
        MatFileUploadComponent.prototype.ngOnDestroy = /**
         * @return {?}
         */
            function () {
                this.stateChanges.complete();
            };
        /**
         * @param {?} files
         * @return {?}
         */
        MatFileUploadComponent.prototype.onChange = /**
         * @param {?} files
         * @return {?}
         */
            function (files) {
                this._value = [];
                this._files = [];
                for (var i = 0; i < files.length; i++) {
                    this._value.push(files[i]);
                    this._files.push(new UploadFile(files[i]));
                }
                this.recalculate();
            };
        /**
         * @param {?} value
         * @return {?}
         */
        MatFileUploadComponent.prototype.writeValue = /**
         * @param {?} value
         * @return {?}
         */
            function (value) { };
        /**
         * @param {?} fn
         * @return {?}
         */
        MatFileUploadComponent.prototype.registerOnChange = /**
         * @param {?} fn
         * @return {?}
         */
            function (fn) {
                this._onChange = fn;
            };
        /**
         * @param {?} fn
         * @return {?}
         */
        MatFileUploadComponent.prototype.registerOnTouched = /**
         * @param {?} fn
         * @return {?}
         */
            function (fn) {
                this.onTouched = fn;
            };
        /**
         * @param {?} isDisabled
         * @return {?}
         */
        MatFileUploadComponent.prototype.setDisabledState = /**
         * @param {?} isDisabled
         * @return {?}
         */
            function (isDisabled) {
                this.disabled = isDisabled;
            };
        /**
         * @return {?}
         */
        MatFileUploadComponent.prototype.onContainerClick = /**
         * @return {?}
         */
            function () { };
        /**
         * @return {?}
         */
        MatFileUploadComponent.prototype.focus = /**
         * @return {?}
         */
            function () { };
        /**
         * @return {?}
         */
        MatFileUploadComponent.prototype.setDescribedByIds = /**
         * @return {?}
         */
            function () { };
        /**
         * @return {?}
         */
        MatFileUploadComponent.prototype.recalculate = /**
         * @return {?}
         */
            function () {
                this.fileUpload.nativeElement.value = '';
                this.visibleValue = this.selectedText(this._files);
                this._onChange(this._value);
                this.onTouched();
                this.updateErrorState();
            };
        MatFileUploadComponent.decorators = [
            { type: core.Component, args: [{
                        exportAs: 'waMatFileUpload',
                        selector: 'wa-mat-file-upload',
                        template: "<ng-template #previewContainer>\n\t<mat-list *ngIf=\"preview && files.length\" [attr.dense]=\"dense ? 'dense' : null\">\n\t\t<ng-container *ngFor=\"let file of files; let isLast = last;\">\n\t\t\t<mat-list-item>\n\t\t\t\t<img *ngIf=\"file.supportsImagePreview(); else listItemIcon\" matListAvatar [src]=\"file.getImageSource() | async\">\n\t\t\t\t<ng-template #listItemIcon>\n\t\t\t\t\t<mat-icon mat-list-icon>{{ file.icon }}</mat-icon>\n\t\t\t\t</ng-template>\n\n\t\t\t\t<h3 matLine>{{ file.file.name }}</h3>\n\n\t\t\t\t<mat-progress-bar *ngIf=\"file.progress\" matLine mode=\"determinate\" [value]=\"file.progress\"></mat-progress-bar>\n\n\t\t\t\t<button *ngIf=\"!disabled && file.progress === 0\" mat-icon-button (click)=\"removeFile(file)\" type=\"button\">\n\t\t\t\t\t<mat-icon>close</mat-icon>\n\t\t\t\t</button>\n\t\t\t</mat-list-item>\n\t\t\t<mat-divider *ngIf=\"!isLast\"></mat-divider>\n\t\t</ng-container>\n\t</mat-list>\n</ng-template>\n\n<ng-container *ngIf=\"previewPosition === 'top'\">\n\t<ng-container *ngTemplateOutlet=\"previewContainer\"></ng-container>\n</ng-container>\n\n<input #fileUpload type=\"file\" (change)=\"onChange($event.target.files)\" [multiple]=\"multiple\" style=\"display: none;\">\n\n<div>\n\t<button mat-raised-button (click)=\"openDialog()\" [color]=\"color\" [disabled]=\"disabled\" type=\"button\"><ng-content></ng-content></button>\n\t<span [ngClass]=\"{'mat-caption': dense}\" style=\"padding-left: 10px;\">\n\t\t{{ visibleValue }}\n\t\t<button *ngIf=\"!disabled && files.length\" mat-icon-button (click)=\"clearFiles()\" type=\"button\">\n\t\t\t<mat-icon>close</mat-icon>\n\t\t</button>\n\t</span>\n</div>\n\n<ng-container *ngIf=\"previewPosition === 'bottom'\">\n\t<ng-container *ngTemplateOutlet=\"previewContainer\"></ng-container>\n</ng-container>\n",
                        providers: [
                            {
                                provide: formField.MatFormFieldControl,
                                useExisting: MatFileUploadComponent,
                            },
                        ]
                    }] }
        ];
        /** @nocollapse */
        MatFileUploadComponent.ctorParameters = function () {
            return [
                { type: core$1.ErrorStateMatcher },
                { type: forms.NgForm, decorators: [{ type: core.Optional }] },
                { type: forms.FormGroupDirective, decorators: [{ type: core.Optional }] },
                { type: forms.NgControl, decorators: [{ type: core.Self }, { type: core.Optional }] }
            ];
        };
        MatFileUploadComponent.propDecorators = {
            placeholder: [{ type: core.Input }],
            required: [{ type: core.Input }],
            multiple: [{ type: core.Input }],
            color: [{ type: core.Input }],
            preview: [{ type: core.Input }],
            previewPosition: [{ type: core.Input }],
            dense: [{ type: core.Input }],
            selectedText: [{ type: core.Input }],
            fileUpload: [{ type: core.ViewChild, args: ['fileUpload',] }],
            value: [{ type: core.Input }],
            disabled: [{ type: core.Input }],
            id: [{ type: core.Input }]
        };
        return MatFileUploadComponent;
    }(_BaseMatFileUploadComponentMixin));
    /**
     * @param {?} files
     * @return {?}
     */
    function defaultSelectedText(files) {
        if (files.length === 0) {
            return '';
        }
        if (files.length === 1) {
            return files[0].file.name;
        }
        return files.length + ' Files selected';
    }

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    var MatFileUploadModule = /** @class */ (function () {
        function MatFileUploadModule() {
        }
        MatFileUploadModule.decorators = [
            { type: core.NgModule, args: [{
                        imports: [
                            common.CommonModule,
                            button.MatButtonModule, divider.MatDividerModule, list.MatListModule, progressBar.MatProgressBarModule, icon.MatIconModule,
                        ],
                        declarations: [
                            MatFileUploadComponent,
                        ],
                        exports: [
                            MatFileUploadComponent,
                        ],
                        providers: [
                            core$1.ErrorStateMatcher,
                        ],
                    },] }
        ];
        return MatFileUploadModule;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    /**
     * @param {?} maxSize
     * @return {?}
     */
    function fileMaxSize(maxSize) {
        return fileValidation(function (file) { return file.size > maxSize; }, function (errors) {
            return {
                fileMaxSize: {
                    maxSize: maxSize,
                    invalidFiles: errors,
                },
            };
        });
    }
    /**
     * @param {?} allowedTypes
     * @return {?}
     */
    function fileType(allowedTypes) {
        return fileValidation(function (file) { return allowedTypes.indexOf(file.type) < 0; }, function (errors) {
            return {
                fileType: {
                    allowedTypes: allowedTypes,
                    invalidFiles: errors,
                },
            };
        });
    }
    /**
     * @param {?} validator
     * @param {?} createErrors
     * @return {?}
     */
    function fileValidation(validator, createErrors) {
        return function (control) {
            if (!control.value) {
                return null;
            }
            /** @type {?} */
            var files = control.value;
            /** @type {?} */
            var errors = [];
            for (var i = 0; i < files.length; i++) {
                if (validator(files[i])) {
                    errors.push(files[i]);
                }
            }
            if (errors.length) {
                return createErrors(errors);
            }
            return null;
        };
    }

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */

    exports.MatFileUploadComponent = MatFileUploadComponent;
    exports.MatFileUploadModule = MatFileUploadModule;
    exports.UploadFile = UploadFile;
    exports.fileMaxSize = fileMaxSize;
    exports.fileType = fileType;
    exports.ɵa = BaseMatFileUploadComponent;
    exports.ɵb = _BaseMatFileUploadComponentMixin;

    Object.defineProperty(exports, '__esModule', { value: true });

})));

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2ViYWNhZC1uZy1tYXQtZmlsZS11cGxvYWQudW1kLmpzLm1hcCIsInNvdXJjZXMiOlsibm9kZV9tb2R1bGVzL3RzbGliL3RzbGliLmVzNi5qcyIsIm5nOi8vQHdlYmFjYWQvbmctbWF0LWZpbGUtdXBsb2FkL3VwbG9hZC1maWxlLnRzIiwibmc6Ly9Ad2ViYWNhZC9uZy1tYXQtZmlsZS11cGxvYWQvbWF0LWZpbGUtdXBsb2FkLmNvbXBvbmVudC50cyIsIm5nOi8vQHdlYmFjYWQvbmctbWF0LWZpbGUtdXBsb2FkL21hdC1maWxlLXVwbG9hZC5tb2R1bGUudHMiLCJuZzovL0B3ZWJhY2FkL25nLW1hdC1maWxlLXVwbG9hZC92YWxpZGF0b3JzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG5Db3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlXHJcbnRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlXHJcbkxpY2Vuc2UgYXQgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcblxyXG5USElTIENPREUgSVMgUFJPVklERUQgT04gQU4gKkFTIElTKiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZXHJcbktJTkQsIEVJVEhFUiBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElORyBXSVRIT1VUIExJTUlUQVRJT04gQU5ZIElNUExJRURcclxuV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIFRJVExFLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSxcclxuTUVSQ0hBTlRBQkxJVFkgT1IgTk9OLUlORlJJTkdFTUVOVC5cclxuXHJcblNlZSB0aGUgQXBhY2hlIFZlcnNpb24gMi4wIExpY2Vuc2UgZm9yIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9uc1xyXG5hbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovXHJcbi8qIGdsb2JhbCBSZWZsZWN0LCBQcm9taXNlICovXHJcblxyXG52YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcclxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XHJcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XHJcbiAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4dGVuZHMoZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG59XHJcblxyXG5leHBvcnQgdmFyIF9fYXNzaWduID0gZnVuY3Rpb24oKSB7XHJcbiAgICBfX2Fzc2lnbiA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gX19hc3NpZ24odCkge1xyXG4gICAgICAgIGZvciAodmFyIHMsIGkgPSAxLCBuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IG47IGkrKykge1xyXG4gICAgICAgICAgICBzID0gYXJndW1lbnRzW2ldO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkpIHRbcF0gPSBzW3BdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdDtcclxuICAgIH1cclxuICAgIHJldHVybiBfX2Fzc2lnbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZXN0KHMsIGUpIHtcclxuICAgIHZhciB0ID0ge307XHJcbiAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkgJiYgZS5pbmRleE9mKHApIDwgMClcclxuICAgICAgICB0W3BdID0gc1twXTtcclxuICAgIGlmIChzICE9IG51bGwgJiYgdHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMgPT09IFwiZnVuY3Rpb25cIilcclxuICAgICAgICBmb3IgKHZhciBpID0gMCwgcCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMocyk7IGkgPCBwLmxlbmd0aDsgaSsrKSBpZiAoZS5pbmRleE9mKHBbaV0pIDwgMClcclxuICAgICAgICAgICAgdFtwW2ldXSA9IHNbcFtpXV07XHJcbiAgICByZXR1cm4gdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcclxuICAgIHZhciBjID0gYXJndW1lbnRzLmxlbmd0aCwgciA9IGMgPCAzID8gdGFyZ2V0IDogZGVzYyA9PT0gbnVsbCA/IGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KSA6IGRlc2MsIGQ7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xyXG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcclxuICAgIHJldHVybiBjID4gMyAmJiByICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgciksIHI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3BhcmFtKHBhcmFtSW5kZXgsIGRlY29yYXRvcikge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIGtleSkgeyBkZWNvcmF0b3IodGFyZ2V0LCBrZXksIHBhcmFtSW5kZXgpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKSB7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QubWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIFJlZmxlY3QubWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdGVyKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xyXG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZShyZXN1bHQudmFsdWUpOyB9KS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XHJcbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2dlbmVyYXRvcih0aGlzQXJnLCBib2R5KSB7XHJcbiAgICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnO1xyXG4gICAgcmV0dXJuIGcgPSB7IG5leHQ6IHZlcmIoMCksIFwidGhyb3dcIjogdmVyYigxKSwgXCJyZXR1cm5cIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgKGdbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSksIGc7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHtcclxuICAgICAgICBpZiAoZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy5cIik7XHJcbiAgICAgICAgd2hpbGUgKF8pIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChmID0gMSwgeSAmJiAodCA9IG9wWzBdICYgMiA/IHlbXCJyZXR1cm5cIl0gOiBvcFswXSA/IHlbXCJ0aHJvd1wiXSB8fCAoKHQgPSB5W1wicmV0dXJuXCJdKSAmJiB0LmNhbGwoeSksIDApIDogeS5uZXh0KSAmJiAhKHQgPSB0LmNhbGwoeSwgb3BbMV0pKS5kb25lKSByZXR1cm4gdDtcclxuICAgICAgICAgICAgaWYgKHkgPSAwLCB0KSBvcCA9IFtvcFswXSAmIDIsIHQudmFsdWVdO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07XHJcbiAgICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH1cclxuICAgICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXhwb3J0U3RhcihtLCBleHBvcnRzKSB7XHJcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3ZhbHVlcyhvKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl0sIGkgPSAwO1xyXG4gICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDtcclxuICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3JlYWQobywgbikge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdO1xyXG4gICAgaWYgKCFtKSByZXR1cm4gbztcclxuICAgIHZhciBpID0gbS5jYWxsKG8pLCByLCBhciA9IFtdLCBlO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICB3aGlsZSAoKG4gPT09IHZvaWQgMCB8fCBuLS0gPiAwKSAmJiAhKHIgPSBpLm5leHQoKSkuZG9uZSkgYXIucHVzaChyLnZhbHVlKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlcnJvcikgeyBlID0geyBlcnJvcjogZXJyb3IgfTsgfVxyXG4gICAgZmluYWxseSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKHIgJiYgIXIuZG9uZSAmJiAobSA9IGlbXCJyZXR1cm5cIl0pKSBtLmNhbGwoaSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZpbmFsbHkgeyBpZiAoZSkgdGhyb3cgZS5lcnJvcjsgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19zcHJlYWQoKSB7XHJcbiAgICBmb3IgKHZhciBhciA9IFtdLCBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKylcclxuICAgICAgICBhciA9IGFyLmNvbmNhdChfX3JlYWQoYXJndW1lbnRzW2ldKSk7XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0KHYpIHtcclxuICAgIHJldHVybiB0aGlzIGluc3RhbmNlb2YgX19hd2FpdCA/ICh0aGlzLnYgPSB2LCB0aGlzKSA6IG5ldyBfX2F3YWl0KHYpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0dlbmVyYXRvcih0aGlzQXJnLCBfYXJndW1lbnRzLCBnZW5lcmF0b3IpIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgZyA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSwgaSwgcSA9IFtdO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlmIChnW25dKSBpW25dID0gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChhLCBiKSB7IHEucHVzaChbbiwgdiwgYSwgYl0pID4gMSB8fCByZXN1bWUobiwgdik7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiByZXN1bWUobiwgdikgeyB0cnkgeyBzdGVwKGdbbl0odikpOyB9IGNhdGNoIChlKSB7IHNldHRsZShxWzBdWzNdLCBlKTsgfSB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKHIpIHsgci52YWx1ZSBpbnN0YW5jZW9mIF9fYXdhaXQgPyBQcm9taXNlLnJlc29sdmUoci52YWx1ZS52KS50aGVuKGZ1bGZpbGwsIHJlamVjdCkgOiBzZXR0bGUocVswXVsyXSwgcik7IH1cclxuICAgIGZ1bmN0aW9uIGZ1bGZpbGwodmFsdWUpIHsgcmVzdW1lKFwibmV4dFwiLCB2YWx1ZSk7IH1cclxuICAgIGZ1bmN0aW9uIHJlamVjdCh2YWx1ZSkgeyByZXN1bWUoXCJ0aHJvd1wiLCB2YWx1ZSk7IH1cclxuICAgIGZ1bmN0aW9uIHNldHRsZShmLCB2KSB7IGlmIChmKHYpLCBxLnNoaWZ0KCksIHEubGVuZ3RoKSByZXN1bWUocVswXVswXSwgcVswXVsxXSk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNEZWxlZ2F0b3Iobykge1xyXG4gICAgdmFyIGksIHA7XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIsIGZ1bmN0aW9uIChlKSB7IHRocm93IGU7IH0pLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuLCBmKSB7IGlbbl0gPSBvW25dID8gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIChwID0gIXApID8geyB2YWx1ZTogX19hd2FpdChvW25dKHYpKSwgZG9uZTogbiA9PT0gXCJyZXR1cm5cIiB9IDogZiA/IGYodikgOiB2OyB9IDogZjsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY1ZhbHVlcyhvKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIG0gPSBvW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSwgaTtcclxuICAgIHJldHVybiBtID8gbS5jYWxsKG8pIDogKG8gPSB0eXBlb2YgX192YWx1ZXMgPT09IFwiZnVuY3Rpb25cIiA/IF9fdmFsdWVzKG8pIDogb1tTeW1ib2wuaXRlcmF0b3JdKCksIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpKTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpW25dID0gb1tuXSAmJiBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgeyB2ID0gb1tuXSh2KSwgc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgdi5kb25lLCB2LnZhbHVlKTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHNldHRsZShyZXNvbHZlLCByZWplY3QsIGQsIHYpIHsgUHJvbWlzZS5yZXNvbHZlKHYpLnRoZW4oZnVuY3Rpb24odikgeyByZXNvbHZlKHsgdmFsdWU6IHYsIGRvbmU6IGQgfSk7IH0sIHJlamVjdCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWFrZVRlbXBsYXRlT2JqZWN0KGNvb2tlZCwgcmF3KSB7XHJcbiAgICBpZiAoT2JqZWN0LmRlZmluZVByb3BlcnR5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjb29rZWQsIFwicmF3XCIsIHsgdmFsdWU6IHJhdyB9KTsgfSBlbHNlIHsgY29va2VkLnJhdyA9IHJhdzsgfVxyXG4gICAgcmV0dXJuIGNvb2tlZDtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydFN0YXIobW9kKSB7XHJcbiAgICBpZiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSByZXR1cm4gbW9kO1xyXG4gICAgdmFyIHJlc3VsdCA9IHt9O1xyXG4gICAgaWYgKG1vZCAhPSBudWxsKSBmb3IgKHZhciBrIGluIG1vZCkgaWYgKE9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZCwgaykpIHJlc3VsdFtrXSA9IG1vZFtrXTtcclxuICAgIHJlc3VsdC5kZWZhdWx0ID0gbW9kO1xyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0RGVmYXVsdChtb2QpIHtcclxuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgZGVmYXVsdDogbW9kIH07XHJcbn1cclxuIiwiaW1wb3J0IHtyZWFkRmlsZUFzRGF0YVVSTH0gZnJvbSAnQHdlYmFjYWQvb2JzZXJ2YWJsZS1maWxlLXJlYWRlcic7XG5pbXBvcnQge09ic2VydmFibGV9IGZyb20gJ3J4anMnO1xuXG5cbmNvbnN0IGltYWdlTWltZVR5cGVzOiBBcnJheTxzdHJpbmc+ID0gW1xuXHQnaW1hZ2UvZ2lmJywgJ2ltYWdlL3BuZycsICdpbWFnZS9qcGVnJyxcbl07XG5cblxuZXhwb3J0IGNsYXNzIFVwbG9hZEZpbGVcbntcblxuXG5cdHB1YmxpYyBpY29uOiBzdHJpbmcgPSAnY2xvdWRfdXBsb2FkJztcblxuXHRwcml2YXRlIGltYWdlU291cmNlOiBPYnNlcnZhYmxlPHN0cmluZz58dW5kZWZpbmVkO1xuXG5cblx0Y29uc3RydWN0b3IoXG5cdFx0cHVibGljIHJlYWRvbmx5IGZpbGU6IEZpbGUsXG5cdFx0cHJpdmF0ZSBfcHJvZ3Jlc3M6IG51bWJlciA9IDAsXG5cdCkge31cblxuXG5cdGdldCBwcm9ncmVzcygpOiBudW1iZXJcblx0e1xuXHRcdHJldHVybiB0aGlzLl9wcm9ncmVzcztcblx0fVxuXG5cdHNldCBwcm9ncmVzcyhwcm9ncmVzczogbnVtYmVyKVxuXHR7XG5cdFx0dGhpcy5fcHJvZ3Jlc3MgPSBwcm9ncmVzcztcblx0fVxuXG5cblx0cHVibGljIHN1cHBvcnRzSW1hZ2VQcmV2aWV3KCk6IGJvb2xlYW5cblx0e1xuXHRcdHJldHVybiBpbWFnZU1pbWVUeXBlcy5pbmRleE9mKHRoaXMuZmlsZS50eXBlKSA+PSAwO1xuXHR9XG5cblxuXHRwdWJsaWMgZ2V0SW1hZ2VTb3VyY2UoKTogT2JzZXJ2YWJsZTxzdHJpbmc+XG5cdHtcblx0XHRpZiAodHlwZW9mIHRoaXMuaW1hZ2VTb3VyY2UgIT09ICd1bmRlZmluZWQnKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5pbWFnZVNvdXJjZTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcy5pbWFnZVNvdXJjZSA9IHJlYWRGaWxlQXNEYXRhVVJMKHRoaXMuZmlsZSk7XG5cdH1cblxuXG5cdHB1YmxpYyBpbmNyZWFzZVByb2dyZXNzKGFkZDogbnVtYmVyKTogdm9pZFxuXHR7XG5cdFx0dGhpcy5wcm9ncmVzcyArPSBhZGQ7XG5cdH1cblxufVxuIiwiaW1wb3J0IHtDb21wb25lbnQsIElucHV0LCBPcHRpb25hbCwgU2VsZiwgT25Jbml0LCBPbkRlc3Ryb3ksIFZpZXdDaGlsZCwgRWxlbWVudFJlZn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge0NvbnRyb2xWYWx1ZUFjY2Vzc29yLCBOZ0Zvcm0sIEZvcm1Hcm91cERpcmVjdGl2ZSwgTmdDb250cm9sfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5pbXBvcnQge0Vycm9yU3RhdGVNYXRjaGVyLCBDYW5VcGRhdGVFcnJvclN0YXRlLCBtaXhpbkVycm9yU3RhdGV9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsL2NvcmUnO1xuaW1wb3J0IHtNYXRGb3JtRmllbGRDb250cm9sfSBmcm9tICdAYW5ndWxhci9tYXRlcmlhbC9mb3JtLWZpZWxkJztcblxuaW1wb3J0IHtVcGxvYWRGaWxlfSBmcm9tICcuL3VwbG9hZC1maWxlJztcblxuXG5sZXQgbmV4dFVuaXF1ZUlkOiBudW1iZXIgPSAwO1xuXG5cbmV4cG9ydCBjbGFzcyBCYXNlTWF0RmlsZVVwbG9hZENvbXBvbmVudFxue1xuXG5cblx0Y29uc3RydWN0b3IoXG5cdFx0cHVibGljIF9kZWZhdWx0RXJyb3JTdGF0ZU1hdGNoZXI6IEVycm9yU3RhdGVNYXRjaGVyLFxuXHRcdHB1YmxpYyBfcGFyZW50Rm9ybTogTmdGb3JtLFxuXHRcdHB1YmxpYyBfcGFyZW50Rm9ybUdyb3VwOiBGb3JtR3JvdXBEaXJlY3RpdmUsXG5cdFx0cHVibGljIG5nQ29udHJvbDogTmdDb250cm9sLFxuXHQpIHt9XG5cbn1cblxuXG5leHBvcnQgY29uc3QgX0Jhc2VNYXRGaWxlVXBsb2FkQ29tcG9uZW50TWl4aW4gPSBtaXhpbkVycm9yU3RhdGUoQmFzZU1hdEZpbGVVcGxvYWRDb21wb25lbnQpO1xuXG5cbkBDb21wb25lbnQoe1xuXHRleHBvcnRBczogJ3dhTWF0RmlsZVVwbG9hZCcsXG5cdHNlbGVjdG9yOiAnd2EtbWF0LWZpbGUtdXBsb2FkJyxcblx0dGVtcGxhdGVVcmw6ICcuL21hdC1maWxlLXVwbG9hZC5jb21wb25lbnQuaHRtbCcsXG5cdHByb3ZpZGVyczogW1xuXHRcdHtcblx0XHRcdHByb3ZpZGU6IE1hdEZvcm1GaWVsZENvbnRyb2wsXG5cdFx0XHR1c2VFeGlzdGluZzogTWF0RmlsZVVwbG9hZENvbXBvbmVudCxcblx0XHR9LFxuXHRdLFxufSlcbmV4cG9ydCBjbGFzcyBNYXRGaWxlVXBsb2FkQ29tcG9uZW50IGV4dGVuZHMgX0Jhc2VNYXRGaWxlVXBsb2FkQ29tcG9uZW50TWl4aW4gaW1wbGVtZW50c1xuXHRPbkluaXQsXG5cdE9uRGVzdHJveSxcblx0Q29udHJvbFZhbHVlQWNjZXNzb3IsXG5cdE1hdEZvcm1GaWVsZENvbnRyb2w8QXJyYXk8RmlsZT4+XG57XG5cblxuXHRASW5wdXQoKVxuXHRwdWJsaWMgcGxhY2Vob2xkZXI6IHN0cmluZztcblxuXHRASW5wdXQoKVxuXHRwdWJsaWMgcmVxdWlyZWQ6IGJvb2xlYW4gPSBmYWxzZTtcblxuXHRASW5wdXQoKVxuXHRwdWJsaWMgbXVsdGlwbGU6IGJvb2xlYW4gPSBmYWxzZTtcblxuXHRASW5wdXQoKVxuXHRwdWJsaWMgY29sb3I6IHN0cmluZ3x1bmRlZmluZWQ7XG5cblx0QElucHV0KClcblx0cHVibGljIHByZXZpZXc6IGJvb2xlYW4gPSBmYWxzZTtcblxuXHRASW5wdXQoKVxuXHRwdWJsaWMgcHJldmlld1Bvc2l0aW9uOiAndG9wJyB8ICdib3R0b20nID0gJ2JvdHRvbSc7XG5cblx0QElucHV0KClcblx0cHVibGljIGRlbnNlOiBib29sZWFuID0gZmFsc2U7XG5cblx0QElucHV0KClcblx0cHVibGljIHNlbGVjdGVkVGV4dDogKGZpbGVzOiBBcnJheTxVcGxvYWRGaWxlPikgPT4gc3RyaW5nID0gZGVmYXVsdFNlbGVjdGVkVGV4dDtcblxuXHRAVmlld0NoaWxkKCdmaWxlVXBsb2FkJylcblx0cHVibGljIGZpbGVVcGxvYWQ6IEVsZW1lbnRSZWY7XG5cblx0cHVibGljIHZpc2libGVWYWx1ZTogc3RyaW5nID0gJyc7XG5cblx0cHVibGljIHNob3VsZExhYmVsRmxvYXQ6IGJvb2xlYW4gPSB0cnVlO1xuXG5cdHByaXZhdGUgX3ZhbHVlOiBBcnJheTxGaWxlPjtcblxuXHRwcml2YXRlIF9maWxlczogQXJyYXk8VXBsb2FkRmlsZT4gPSBbXTtcblxuXHRwcml2YXRlIF9kaXNhYmxlZDogYm9vbGVhbjtcblxuXHRwcml2YXRlIF9pZDogc3RyaW5nO1xuXG5cdHByaXZhdGUgX3VpZDogc3RyaW5nID0gYHdhLW1hdC1maWxlLXVwbG9hZC0ke25leHRVbmlxdWVJZCsrfWA7XG5cblxuXHRjb25zdHJ1Y3Rvcihcblx0XHRkZWZhdWx0RXJyb3JTdGF0ZU1hdGNoZXI6IEVycm9yU3RhdGVNYXRjaGVyLFxuXHRcdEBPcHRpb25hbCgpIHBhcmVudEZvcm06IE5nRm9ybSxcblx0XHRAT3B0aW9uYWwoKSBwYXJlbnRGb3JtR3JvdXA6IEZvcm1Hcm91cERpcmVjdGl2ZSxcblx0XHRAU2VsZigpIEBPcHRpb25hbCgpIHB1YmxpYyByZWFkb25seSBuZ0NvbnRyb2w6IE5nQ29udHJvbCxcblx0KSB7XG5cdFx0c3VwZXIoZGVmYXVsdEVycm9yU3RhdGVNYXRjaGVyLCBwYXJlbnRGb3JtLCBwYXJlbnRGb3JtR3JvdXAsIG5nQ29udHJvbCk7XG5cblx0XHRpZiAodGhpcy5uZ0NvbnRyb2wgIT09IG51bGwpIHtcblx0XHRcdHRoaXMubmdDb250cm9sLnZhbHVlQWNjZXNzb3IgPSB0aGlzO1xuXHRcdH1cblx0fVxuXG5cblx0QElucHV0KClcblx0Z2V0IHZhbHVlKCk6IEFycmF5PEZpbGU+XG5cdHtcblx0XHRyZXR1cm4gdGhpcy5fdmFsdWU7XG5cdH1cblxuXHRzZXQgdmFsdWUodmFsdWU6IEFycmF5PEZpbGU+KSB7fVxuXG5cblx0QElucHV0KClcblx0Z2V0IGRpc2FibGVkKCk6IGJvb2xlYW5cblx0e1xuXHRcdGlmICh0eXBlb2YgdGhpcy5fZGlzYWJsZWQgIT09ICd1bmRlZmluZWQnKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5fZGlzYWJsZWQ7XG5cdFx0fVxuXG5cdFx0aWYgKHRoaXMubmdDb250cm9sICYmIHRoaXMubmdDb250cm9sLmRpc2FibGVkICE9PSBudWxsKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5uZ0NvbnRyb2wuZGlzYWJsZWQ7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG5cblx0c2V0IGRpc2FibGVkKGRpc2FibGVkOiBib29sZWFuKVxuXHR7XG5cdFx0dGhpcy5fZGlzYWJsZWQgPSBkaXNhYmxlZDtcblx0fVxuXG5cblx0QElucHV0KClcblx0Z2V0IGlkKCk6IHN0cmluZ1xuXHR7XG5cdFx0cmV0dXJuIHRoaXMuX2lkO1xuXHR9XG5cblx0c2V0IGlkKGlkOiBzdHJpbmcpXG5cdHtcblx0XHR0aGlzLl9pZCA9IGlkIHx8IHRoaXMuX3VpZDtcblx0fVxuXG5cblx0Z2V0IGZpbGVzKCk6IEFycmF5PFVwbG9hZEZpbGU+XG5cdHtcblx0XHRyZXR1cm4gdGhpcy5fZmlsZXM7XG5cdH1cblxuXG5cdGdldCBlbXB0eSgpOiBib29sZWFuXG5cdHtcblx0XHRyZXR1cm4gdHlwZW9mIHRoaXMuX3ZhbHVlID09PSAndW5kZWZpbmVkJztcblx0fVxuXG5cblx0Z2V0IGZvY3VzZWQoKTogYm9vbGVhblxuXHR7XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG5cblxuXHRwdWJsaWMgb3BlbkRpYWxvZygpOiB2b2lkXG5cdHtcblx0XHRpZiAodGhpcy5maWxlVXBsb2FkKSB7XG5cdFx0XHR0aGlzLmZpbGVVcGxvYWQubmF0aXZlRWxlbWVudC5jbGljaygpO1xuXHRcdH1cblx0fVxuXG5cblx0cHVibGljIGNsZWFyRmlsZXMoKTogdm9pZFxuXHR7XG5cdFx0dGhpcy5fdmFsdWUgPSBbXTtcblx0XHR0aGlzLl9maWxlcyA9IFtdO1xuXHRcdHRoaXMucmVjYWxjdWxhdGUoKTtcblx0fVxuXG5cblx0cHVibGljIHJlbW92ZUZpbGUoZmlsZTogVXBsb2FkRmlsZSk6IHZvaWRcblx0e1xuXHRcdHRoaXMuX3ZhbHVlLnNwbGljZSh0aGlzLl92YWx1ZS5pbmRleE9mKGZpbGUuZmlsZSksIDEpO1xuXHRcdHRoaXMuX2ZpbGVzLnNwbGljZSh0aGlzLl9maWxlcy5pbmRleE9mKGZpbGUpLCAxKTtcblx0XHR0aGlzLnJlY2FsY3VsYXRlKCk7XG5cdH1cblxuXG5cdHB1YmxpYyBuZ09uSW5pdCgpOiB2b2lkXG5cdHtcblx0XHR0aGlzLnZpc2libGVWYWx1ZSA9IHRoaXMuc2VsZWN0ZWRUZXh0KHRoaXMuX2ZpbGVzKTtcblx0fVxuXG5cblx0cHVibGljIG5nT25EZXN0cm95KCk6IHZvaWRcblx0e1xuXHRcdHRoaXMuc3RhdGVDaGFuZ2VzLmNvbXBsZXRlKCk7XG5cdH1cblxuXG5cdHB1YmxpYyBvblRvdWNoZWQgPSAoKSA9PiB7fTtcblxuXG5cdHB1YmxpYyBvbkNoYW5nZShmaWxlczogRmlsZUxpc3QpOiB2b2lkXG5cdHtcblx0XHR0aGlzLl92YWx1ZSA9IFtdO1xuXHRcdHRoaXMuX2ZpbGVzID0gW107XG5cblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGZpbGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHR0aGlzLl92YWx1ZS5wdXNoKGZpbGVzW2ldKTtcblx0XHRcdHRoaXMuX2ZpbGVzLnB1c2gobmV3IFVwbG9hZEZpbGUoZmlsZXNbaV0pKTtcblx0XHR9XG5cblx0XHR0aGlzLnJlY2FsY3VsYXRlKCk7XG5cdH1cblxuXG5cdHB1YmxpYyB3cml0ZVZhbHVlKHZhbHVlOiBhbnkpOiB2b2lkIHt9XG5cblxuXHRwdWJsaWMgcmVnaXN0ZXJPbkNoYW5nZShmbjogKF86IGFueSkgPT4gdm9pZCk6IHZvaWRcblx0e1xuXHRcdHRoaXMuX29uQ2hhbmdlID0gZm47XG5cdH1cblxuXG5cdHB1YmxpYyByZWdpc3Rlck9uVG91Y2hlZChmbjogKCkgPT4gdm9pZCk6IHZvaWRcblx0e1xuXHRcdHRoaXMub25Ub3VjaGVkID0gZm47XG5cdH1cblxuXG5cdHB1YmxpYyBzZXREaXNhYmxlZFN0YXRlKGlzRGlzYWJsZWQ6IGJvb2xlYW4pOiB2b2lkXG5cdHtcblx0XHR0aGlzLmRpc2FibGVkID0gaXNEaXNhYmxlZDtcblx0fVxuXG5cblx0cHVibGljIG9uQ29udGFpbmVyQ2xpY2soKTogdm9pZCB7fVxuXG5cblx0cHVibGljIGZvY3VzKCk6IHZvaWQge31cblxuXG5cdHB1YmxpYyBzZXREZXNjcmliZWRCeUlkcygpOiB2b2lkIHt9XG5cblxuXHRwcml2YXRlIF9vbkNoYW5nZSA9IChfOiBhbnkpID0+IHt9O1xuXG5cblx0cHJpdmF0ZSByZWNhbGN1bGF0ZSgpOiB2b2lkXG5cdHtcblx0XHR0aGlzLmZpbGVVcGxvYWQubmF0aXZlRWxlbWVudC52YWx1ZSA9ICcnO1xuXHRcdHRoaXMudmlzaWJsZVZhbHVlID0gdGhpcy5zZWxlY3RlZFRleHQodGhpcy5fZmlsZXMpO1xuXG5cdFx0dGhpcy5fb25DaGFuZ2UodGhpcy5fdmFsdWUpO1xuXHRcdHRoaXMub25Ub3VjaGVkKCk7XG5cdFx0dGhpcy51cGRhdGVFcnJvclN0YXRlKCk7XG5cdH1cblxufVxuXG5cbmZ1bmN0aW9uIGRlZmF1bHRTZWxlY3RlZFRleHQoZmlsZXM6IEFycmF5PFVwbG9hZEZpbGU+KTogc3RyaW5nXG57XG5cdGlmIChmaWxlcy5sZW5ndGggPT09IDApIHtcblx0XHRyZXR1cm4gJyc7XG5cdH1cblxuXHRpZiAoZmlsZXMubGVuZ3RoID09PSAxKSB7XG5cdFx0cmV0dXJuIGZpbGVzWzBdLmZpbGUubmFtZTtcblx0fVxuXG5cdHJldHVybiBmaWxlcy5sZW5ndGggKyAnIEZpbGVzIHNlbGVjdGVkJztcbn1cbiIsImltcG9ydCB7TmdNb2R1bGV9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHtDb21tb25Nb2R1bGV9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQge0Vycm9yU3RhdGVNYXRjaGVyfSBmcm9tICdAYW5ndWxhci9tYXRlcmlhbC9jb3JlJztcbmltcG9ydCB7TWF0QnV0dG9uTW9kdWxlfSBmcm9tICdAYW5ndWxhci9tYXRlcmlhbC9idXR0b24nO1xuaW1wb3J0IHtNYXREaXZpZGVyTW9kdWxlfSBmcm9tICdAYW5ndWxhci9tYXRlcmlhbC9kaXZpZGVyJztcbmltcG9ydCB7TWF0TGlzdE1vZHVsZX0gZnJvbSAnQGFuZ3VsYXIvbWF0ZXJpYWwvbGlzdCc7XG5pbXBvcnQge01hdFByb2dyZXNzQmFyTW9kdWxlfSBmcm9tICdAYW5ndWxhci9tYXRlcmlhbC9wcm9ncmVzcy1iYXInO1xuaW1wb3J0IHtNYXRJY29uTW9kdWxlfSBmcm9tICdAYW5ndWxhci9tYXRlcmlhbC9pY29uJztcblxuaW1wb3J0IHtNYXRGaWxlVXBsb2FkQ29tcG9uZW50fSBmcm9tICcuL21hdC1maWxlLXVwbG9hZC5jb21wb25lbnQnO1xuXG5cbkBOZ01vZHVsZSh7XG5cdGltcG9ydHM6IFtcblx0XHRDb21tb25Nb2R1bGUsXG5cdFx0TWF0QnV0dG9uTW9kdWxlLCBNYXREaXZpZGVyTW9kdWxlLCBNYXRMaXN0TW9kdWxlLCBNYXRQcm9ncmVzc0Jhck1vZHVsZSwgTWF0SWNvbk1vZHVsZSxcblx0XSxcblx0ZGVjbGFyYXRpb25zOiBbXG5cdFx0TWF0RmlsZVVwbG9hZENvbXBvbmVudCxcblx0XSxcblx0ZXhwb3J0czogW1xuXHRcdE1hdEZpbGVVcGxvYWRDb21wb25lbnQsXG5cdF0sXG5cdHByb3ZpZGVyczogW1xuXHRcdEVycm9yU3RhdGVNYXRjaGVyLFxuXHRdLFxufSlcbmV4cG9ydCBjbGFzcyBNYXRGaWxlVXBsb2FkTW9kdWxlIHt9XG4iLCJpbXBvcnQge0Fic3RyYWN0Q29udHJvbCwgVmFsaWRhdGlvbkVycm9ycywgVmFsaWRhdG9yRm59IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcblxuXG5leHBvcnQgZnVuY3Rpb24gZmlsZU1heFNpemUobWF4U2l6ZTogbnVtYmVyKTogVmFsaWRhdG9yRm5cbntcblx0cmV0dXJuIGZpbGVWYWxpZGF0aW9uKChmaWxlKSA9PiBmaWxlLnNpemUgPiBtYXhTaXplLCAoZXJyb3JzKSA9PiB7XG5cdFx0cmV0dXJuIHtcblx0XHRcdGZpbGVNYXhTaXplOiB7XG5cdFx0XHRcdG1heFNpemU6IG1heFNpemUsXG5cdFx0XHRcdGludmFsaWRGaWxlczogZXJyb3JzLFxuXHRcdFx0fSxcblx0XHR9O1xuXHR9KTtcbn1cblxuXG5leHBvcnQgZnVuY3Rpb24gZmlsZVR5cGUoYWxsb3dlZFR5cGVzOiBBcnJheTxzdHJpbmc+KTogVmFsaWRhdG9yRm5cbntcblx0cmV0dXJuIGZpbGVWYWxpZGF0aW9uKChmaWxlKSA9PiBhbGxvd2VkVHlwZXMuaW5kZXhPZihmaWxlLnR5cGUpIDwgMCwgKGVycm9ycykgPT4ge1xuXHRcdHJldHVybiB7XG5cdFx0XHRmaWxlVHlwZToge1xuXHRcdFx0XHRhbGxvd2VkVHlwZXM6IGFsbG93ZWRUeXBlcyxcblx0XHRcdFx0aW52YWxpZEZpbGVzOiBlcnJvcnMsXG5cdFx0XHR9LFxuXHRcdH07XG5cdH0pO1xufVxuXG5cbmZ1bmN0aW9uIGZpbGVWYWxpZGF0aW9uKHZhbGlkYXRvcjogKGZpbGU6IEJsb2IpID0+IGJvb2xlYW4sIGNyZWF0ZUVycm9yczogKGVycm9yRmlsZXM6IEFycmF5PEJsb2I+KSA9PiBWYWxpZGF0aW9uRXJyb3JzKTogVmFsaWRhdG9yRm5cbntcblx0cmV0dXJuIChjb250cm9sOiBBYnN0cmFjdENvbnRyb2wpOiBWYWxpZGF0aW9uRXJyb3JzID0+IHtcblx0XHRpZiAoIWNvbnRyb2wudmFsdWUpIHtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblxuXHRcdGNvbnN0IGZpbGVzOiBGaWxlTGlzdCA9IGNvbnRyb2wudmFsdWU7XG5cdFx0Y29uc3QgZXJyb3JzOiBBcnJheTxhbnk+ID0gW107XG5cblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGZpbGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRpZiAodmFsaWRhdG9yKGZpbGVzW2ldKSkge1xuXHRcdFx0XHRlcnJvcnMucHVzaChmaWxlc1tpXSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aWYgKGVycm9ycy5sZW5ndGgpIHtcblx0XHRcdHJldHVybiBjcmVhdGVFcnJvcnMoZXJyb3JzKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gbnVsbDtcblx0fTtcbn1cblxuIl0sIm5hbWVzIjpbInJlYWRGaWxlQXNEYXRhVVJMIiwibWl4aW5FcnJvclN0YXRlIiwidHNsaWJfMS5fX2V4dGVuZHMiLCJDb21wb25lbnQiLCJNYXRGb3JtRmllbGRDb250cm9sIiwiRXJyb3JTdGF0ZU1hdGNoZXIiLCJOZ0Zvcm0iLCJPcHRpb25hbCIsIkZvcm1Hcm91cERpcmVjdGl2ZSIsIk5nQ29udHJvbCIsIlNlbGYiLCJJbnB1dCIsIlZpZXdDaGlsZCIsIk5nTW9kdWxlIiwiQ29tbW9uTW9kdWxlIiwiTWF0QnV0dG9uTW9kdWxlIiwiTWF0RGl2aWRlck1vZHVsZSIsIk1hdExpc3RNb2R1bGUiLCJNYXRQcm9ncmVzc0Jhck1vZHVsZSIsIk1hdEljb25Nb2R1bGUiXSwibWFwcGluZ3MiOiI7Ozs7OztJQUFBOzs7Ozs7Ozs7Ozs7OztJQWNBO0lBRUEsSUFBSSxhQUFhLEdBQUcsVUFBUyxDQUFDLEVBQUUsQ0FBQztRQUM3QixhQUFhLEdBQUcsTUFBTSxDQUFDLGNBQWM7YUFDaEMsRUFBRSxTQUFTLEVBQUUsRUFBRSxFQUFFLFlBQVksS0FBSyxJQUFJLFVBQVUsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUMsU0FBUyxHQUFHLENBQUMsQ0FBQyxFQUFFLENBQUM7WUFDNUUsVUFBVSxDQUFDLEVBQUUsQ0FBQyxJQUFJLEtBQUssSUFBSSxDQUFDLElBQUksQ0FBQztnQkFBRSxJQUFJLENBQUMsQ0FBQyxjQUFjLENBQUMsQ0FBQyxDQUFDO29CQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDO1FBQy9FLE9BQU8sYUFBYSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztJQUMvQixDQUFDLENBQUM7QUFFRix1QkFBMEIsQ0FBQyxFQUFFLENBQUM7UUFDMUIsYUFBYSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUNwQixnQkFBZ0IsSUFBSSxDQUFDLFdBQVcsR0FBRyxDQUFDLENBQUMsRUFBRTtRQUN2QyxDQUFDLENBQUMsU0FBUyxHQUFHLENBQUMsS0FBSyxJQUFJLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUMsU0FBUyxHQUFHLENBQUMsQ0FBQyxTQUFTLEVBQUUsSUFBSSxFQUFFLEVBQUUsQ0FBQyxDQUFDO0lBQ3pGLENBQUM7Ozs7OztBQzNCRDtJQUlBLElBQU0sY0FBYyxHQUFrQjtRQUNyQyxXQUFXLEVBQUUsV0FBVyxFQUFFLFlBQVk7S0FDdEMsQ0FBQztBQUdGLFFBQUE7UUFTQyxvQkFDaUIsTUFDUjs7OztZQURRLFNBQUksR0FBSixJQUFJO1lBQ1osY0FBUyxHQUFULFNBQVM7d0JBUEksY0FBYztTQVFoQztRQUdKLHNCQUFJLGdDQUFROzs7Z0JBQVo7Z0JBRUMsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDO2FBQ3RCOzs7O2dCQUVELFVBQWEsUUFBZ0I7Z0JBRTVCLElBQUksQ0FBQyxTQUFTLEdBQUcsUUFBUSxDQUFDO2FBQzFCOzs7V0FMQTs7OztRQVFNLHlDQUFvQjs7OztnQkFFMUIsT0FBTyxjQUFjLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDOzs7OztRQUk3QyxtQ0FBYzs7OztnQkFFcEIsSUFBSSxPQUFPLElBQUksQ0FBQyxXQUFXLEtBQUssV0FBVyxFQUFFO29CQUM1QyxPQUFPLElBQUksQ0FBQyxXQUFXLENBQUM7aUJBQ3hCO2dCQUVELE9BQU8sSUFBSSxDQUFDLFdBQVcsR0FBR0Esc0NBQWlCLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDOzs7Ozs7UUFJakQscUNBQWdCOzs7O3NCQUFDLEdBQVc7Z0JBRWxDLElBQUksQ0FBQyxRQUFRLElBQUksR0FBRyxDQUFDOzt5QkFyRHZCO1FBd0RDOzs7Ozs7O0lDaERELElBQUksWUFBWSxHQUFXLENBQUMsQ0FBQztBQUc3QixRQUFBO1FBSUMsb0NBQ1EsMkJBQ0EsYUFDQSxrQkFDQTtZQUhBLDhCQUF5QixHQUF6Qix5QkFBeUI7WUFDekIsZ0JBQVcsR0FBWCxXQUFXO1lBQ1gscUJBQWdCLEdBQWhCLGdCQUFnQjtZQUNoQixjQUFTLEdBQVQsU0FBUztTQUNiO3lDQXBCTDtRQXNCQyxDQUFBO0FBWEQ7QUFjQSxRQUFhLGdDQUFnQyxHQUFHQyxzQkFBZSxDQUFDLDBCQUEwQixDQUFDLENBQUM7O1FBY2hEQywwQ0FBZ0M7UUFrRDNFLGdDQUNDLHdCQUEyQyxFQUMvQixVQUFrQixFQUNsQixlQUFtQyxFQUNYLFNBQW9CO1lBSnpELFlBTUMsa0JBQU0sd0JBQXdCLEVBQUUsVUFBVSxFQUFFLGVBQWUsRUFBRSxTQUFTLENBQUMsU0FLdkU7WUFQb0MsZUFBUyxHQUFULFNBQVMsQ0FBVzs2QkExQzlCLEtBQUs7NkJBR0wsS0FBSzs0QkFNTixLQUFLO29DQUdZLFFBQVE7MEJBRzNCLEtBQUs7aUNBRytCLG1CQUFtQjtpQ0FLakQsRUFBRTtxQ0FFRyxJQUFJOzJCQUlILEVBQUU7eUJBTWYsd0JBQXNCLFlBQVksRUFBSTs4QkFnSDFDLGVBQVE7OEJBK0NQLFVBQUMsQ0FBTSxLQUFPO1lBcEpqQyxJQUFJLEtBQUksQ0FBQyxTQUFTLEtBQUssSUFBSSxFQUFFO2dCQUM1QixLQUFJLENBQUMsU0FBUyxDQUFDLGFBQWEsR0FBRyxLQUFJLENBQUM7YUFDcEM7O1NBQ0Q7UUFHRCxzQkFDSSx5Q0FBSzs7O2dCQURUO2dCQUdDLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQzthQUNuQjs7OztnQkFFRCxVQUFVLEtBQWtCLEtBQUk7OztXQUYvQjtRQUtELHNCQUNJLDRDQUFROzs7Z0JBRFo7Z0JBR0MsSUFBSSxPQUFPLElBQUksQ0FBQyxTQUFTLEtBQUssV0FBVyxFQUFFO29CQUMxQyxPQUFPLElBQUksQ0FBQyxTQUFTLENBQUM7aUJBQ3RCO2dCQUVELElBQUksSUFBSSxDQUFDLFNBQVMsSUFBSSxJQUFJLENBQUMsU0FBUyxDQUFDLFFBQVEsS0FBSyxJQUFJLEVBQUU7b0JBQ3ZELE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUM7aUJBQy9CO2dCQUVELE9BQU8sS0FBSyxDQUFDO2FBQ2I7Ozs7Z0JBRUQsVUFBYSxRQUFpQjtnQkFFN0IsSUFBSSxDQUFDLFNBQVMsR0FBRyxRQUFRLENBQUM7YUFDMUI7OztXQUxBO1FBUUQsc0JBQ0ksc0NBQUU7OztnQkFETjtnQkFHQyxPQUFPLElBQUksQ0FBQyxHQUFHLENBQUM7YUFDaEI7Ozs7Z0JBRUQsVUFBTyxFQUFVO2dCQUVoQixJQUFJLENBQUMsR0FBRyxHQUFHLEVBQUUsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDO2FBQzNCOzs7V0FMQTtRQVFELHNCQUFJLHlDQUFLOzs7Z0JBQVQ7Z0JBRUMsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDO2FBQ25COzs7V0FBQTtRQUdELHNCQUFJLHlDQUFLOzs7Z0JBQVQ7Z0JBRUMsT0FBTyxPQUFPLElBQUksQ0FBQyxNQUFNLEtBQUssV0FBVyxDQUFDO2FBQzFDOzs7V0FBQTtRQUdELHNCQUFJLDJDQUFPOzs7Z0JBQVg7Z0JBRUMsT0FBTyxLQUFLLENBQUM7YUFDYjs7O1dBQUE7Ozs7UUFHTSwyQ0FBVTs7OztnQkFFaEIsSUFBSSxJQUFJLENBQUMsVUFBVSxFQUFFO29CQUNwQixJQUFJLENBQUMsVUFBVSxDQUFDLGFBQWEsQ0FBQyxLQUFLLEVBQUUsQ0FBQztpQkFDdEM7Ozs7O1FBSUssMkNBQVU7Ozs7Z0JBRWhCLElBQUksQ0FBQyxNQUFNLEdBQUcsRUFBRSxDQUFDO2dCQUNqQixJQUFJLENBQUMsTUFBTSxHQUFHLEVBQUUsQ0FBQztnQkFDakIsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDOzs7Ozs7UUFJYiwyQ0FBVTs7OztzQkFBQyxJQUFnQjtnQkFFakMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO2dCQUN0RCxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztnQkFDakQsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDOzs7OztRQUliLHlDQUFROzs7O2dCQUVkLElBQUksQ0FBQyxZQUFZLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7Ozs7O1FBSTdDLDRDQUFXOzs7O2dCQUVqQixJQUFJLENBQUMsWUFBWSxDQUFDLFFBQVEsRUFBRSxDQUFDOzs7Ozs7UUFPdkIseUNBQVE7Ozs7c0JBQUMsS0FBZTtnQkFFOUIsSUFBSSxDQUFDLE1BQU0sR0FBRyxFQUFFLENBQUM7Z0JBQ2pCLElBQUksQ0FBQyxNQUFNLEdBQUcsRUFBRSxDQUFDO2dCQUVqQixLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsS0FBSyxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtvQkFDdEMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7b0JBQzNCLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksVUFBVSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7aUJBQzNDO2dCQUVELElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQzs7Ozs7O1FBSWIsMkNBQVU7Ozs7c0JBQUMsS0FBVTs7Ozs7UUFHckIsaURBQWdCOzs7O3NCQUFDLEVBQW9CO2dCQUUzQyxJQUFJLENBQUMsU0FBUyxHQUFHLEVBQUUsQ0FBQzs7Ozs7O1FBSWQsa0RBQWlCOzs7O3NCQUFDLEVBQWM7Z0JBRXRDLElBQUksQ0FBQyxTQUFTLEdBQUcsRUFBRSxDQUFDOzs7Ozs7UUFJZCxpREFBZ0I7Ozs7c0JBQUMsVUFBbUI7Z0JBRTFDLElBQUksQ0FBQyxRQUFRLEdBQUcsVUFBVSxDQUFDOzs7OztRQUlyQixpREFBZ0I7Ozs7Ozs7UUFHaEIsc0NBQUs7Ozs7Ozs7UUFHTCxrREFBaUI7Ozs7Ozs7UUFNaEIsNENBQVc7Ozs7Z0JBRWxCLElBQUksQ0FBQyxVQUFVLENBQUMsYUFBYSxDQUFDLEtBQUssR0FBRyxFQUFFLENBQUM7Z0JBQ3pDLElBQUksQ0FBQyxZQUFZLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7Z0JBRW5ELElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO2dCQUM1QixJQUFJLENBQUMsU0FBUyxFQUFFLENBQUM7Z0JBQ2pCLElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDOzs7b0JBbk96QkMsY0FBUyxTQUFDO3dCQUNWLFFBQVEsRUFBRSxpQkFBaUI7d0JBQzNCLFFBQVEsRUFBRSxvQkFBb0I7d0JBQzlCLG14REFBK0M7d0JBQy9DLFNBQVMsRUFBRTs0QkFDVjtnQ0FDQyxPQUFPLEVBQUVDLDZCQUFtQjtnQ0FDNUIsV0FBVyxFQUFFLHNCQUFzQjs2QkFDbkM7eUJBQ0Q7cUJBQ0Q7Ozs7O3dCQXBDT0Msd0JBQWlCO3dCQURLQyxZQUFNLHVCQTBGakNDLGFBQVE7d0JBMUYyQkMsd0JBQWtCLHVCQTJGckRELGFBQVE7d0JBM0YrQ0UsZUFBUyx1QkE0RmhFQyxTQUFJLFlBQUlILGFBQVE7Ozs7a0NBOUNqQkksVUFBSzsrQkFHTEEsVUFBSzsrQkFHTEEsVUFBSzs0QkFHTEEsVUFBSzs4QkFHTEEsVUFBSztzQ0FHTEEsVUFBSzs0QkFHTEEsVUFBSzttQ0FHTEEsVUFBSztpQ0FHTEMsY0FBUyxTQUFDLFlBQVk7NEJBZ0N0QkQsVUFBSzsrQkFTTEEsVUFBSzt5QkFvQkxBLFVBQUs7O3FDQXBJUDtNQXVDNEMsZ0NBQWdDOzs7OztJQThONUUsNkJBQTZCLEtBQXdCO1FBRXBELElBQUksS0FBSyxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUU7WUFDdkIsT0FBTyxFQUFFLENBQUM7U0FDVjtRQUVELElBQUksS0FBSyxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUU7WUFDdkIsT0FBTyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQztTQUMxQjtRQUVELE9BQU8sS0FBSyxDQUFDLE1BQU0sR0FBRyxpQkFBaUIsQ0FBQztLQUN4Qzs7Ozs7O0FDaFJEOzs7O29CQVlDRSxhQUFRLFNBQUM7d0JBQ1QsT0FBTyxFQUFFOzRCQUNSQyxtQkFBWTs0QkFDWkMsc0JBQWUsRUFBRUMsd0JBQWdCLEVBQUVDLGtCQUFhLEVBQUVDLGdDQUFvQixFQUFFQyxrQkFBYTt5QkFDckY7d0JBQ0QsWUFBWSxFQUFFOzRCQUNiLHNCQUFzQjt5QkFDdEI7d0JBQ0QsT0FBTyxFQUFFOzRCQUNSLHNCQUFzQjt5QkFDdEI7d0JBQ0QsU0FBUyxFQUFFOzRCQUNWZCx3QkFBaUI7eUJBQ2pCO3FCQUNEOztrQ0ExQkQ7Ozs7Ozs7Ozs7O0FDR0EseUJBQTRCLE9BQWU7UUFFMUMsT0FBTyxjQUFjLENBQUMsVUFBQyxJQUFJLElBQUssT0FBQSxJQUFJLENBQUMsSUFBSSxHQUFHLE9BQU8sR0FBQSxFQUFFLFVBQUMsTUFBTTtZQUMzRCxPQUFPO2dCQUNOLFdBQVcsRUFBRTtvQkFDWixPQUFPLEVBQUUsT0FBTztvQkFDaEIsWUFBWSxFQUFFLE1BQU07aUJBQ3BCO2FBQ0QsQ0FBQztTQUNGLENBQUMsQ0FBQztLQUNIOzs7OztBQUdELHNCQUF5QixZQUEyQjtRQUVuRCxPQUFPLGNBQWMsQ0FBQyxVQUFDLElBQUksSUFBSyxPQUFBLFlBQVksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBQSxFQUFFLFVBQUMsTUFBTTtZQUMzRSxPQUFPO2dCQUNOLFFBQVEsRUFBRTtvQkFDVCxZQUFZLEVBQUUsWUFBWTtvQkFDMUIsWUFBWSxFQUFFLE1BQU07aUJBQ3BCO2FBQ0QsQ0FBQztTQUNGLENBQUMsQ0FBQztLQUNIOzs7Ozs7SUFHRCx3QkFBd0IsU0FBa0MsRUFBRSxZQUEyRDtRQUV0SCxPQUFPLFVBQUMsT0FBd0I7WUFDL0IsSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLEVBQUU7Z0JBQ25CLE9BQU8sSUFBSSxDQUFDO2FBQ1o7O1lBRUQsSUFBTSxLQUFLLEdBQWEsT0FBTyxDQUFDLEtBQUssQ0FBQzs7WUFDdEMsSUFBTSxNQUFNLEdBQWUsRUFBRSxDQUFDO1lBRTlCLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxLQUFLLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFO2dCQUN0QyxJQUFJLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRTtvQkFDeEIsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztpQkFDdEI7YUFDRDtZQUVELElBQUksTUFBTSxDQUFDLE1BQU0sRUFBRTtnQkFDbEIsT0FBTyxZQUFZLENBQUMsTUFBTSxDQUFDLENBQUM7YUFDNUI7WUFFRCxPQUFPLElBQUksQ0FBQztTQUNaLENBQUM7S0FDRjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OzsifQ==