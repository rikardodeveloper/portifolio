!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@webacad/observable-file-reader"),require("@angular/core"),require("@angular/forms"),require("@angular/material/core"),require("@angular/material/form-field"),require("@angular/common"),require("@angular/material/button"),require("@angular/material/divider"),require("@angular/material/list"),require("@angular/material/progress-bar"),require("@angular/material/icon")):"function"==typeof define&&define.amd?define("@webacad/ng-mat-file-upload",["exports","@webacad/observable-file-reader","@angular/core","@angular/forms","@angular/material/core","@angular/material/form-field","@angular/common","@angular/material/button","@angular/material/divider","@angular/material/list","@angular/material/progress-bar","@angular/material/icon"],t):t((e.webacad=e.webacad||{},e.webacad["ng-mat-file-upload"]={}),e.observableFileReader,e.ng.core,e.ng.forms,e.ng.material.core,e.ng.material["form-field"],e.ng.common,e.ng.material.button,e.ng.material.divider,e.ng.material.list,e.ng.material["progress-bar"],e.ng.material.icon)}(this,function(e,t,n,r,a,l,i,o,s,u,p,c){"use strict";var f=function(e,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};var d=["image/gif","image/png","image/jpeg"],g=function(){function e(e,t){void 0===t&&(t=0),this.file=e,this._progress=t,this.icon="cloud_upload"}return Object.defineProperty(e.prototype,"progress",{get:function(){return this._progress},set:function(e){this._progress=e},enumerable:!0,configurable:!0}),e.prototype.supportsImagePreview=function(){return 0<=d.indexOf(this.file.type)},e.prototype.getImageSource=function(){return"undefined"!=typeof this.imageSource?this.imageSource:this.imageSource=t.readFileAsDataURL(this.file)},e.prototype.increaseProgress=function(e){this.progress+=e},e}(),m=0,h=function w(e,t,n,i){this._defaultErrorStateMatcher=e,this._parentForm=t,this._parentFormGroup=n,this.ngControl=i},y=a.mixinErrorState(h),b=function(o){function e(e,t,n,i){var r=o.call(this,e,t,n,i)||this;return r.ngControl=i,r.required=!1,r.multiple=!1,r.preview=!1,r.previewPosition="bottom",r.dense=!1,r.selectedText=v,r.visibleValue="",r.shouldLabelFloat=!0,r._files=[],r._uid="wa-mat-file-upload-"+m++,r.onTouched=function(){},r._onChange=function(e){},null!==r.ngControl&&(r.ngControl.valueAccessor=r),r}return function i(e,t){function n(){this.constructor=e}f(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(e,o),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"disabled",{get:function(){return"undefined"!=typeof this._disabled?this._disabled:!(!this.ngControl||null===this.ngControl.disabled)&&this.ngControl.disabled},set:function(e){this._disabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},set:function(e){this._id=e||this._uid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"files",{get:function(){return this._files},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return"undefined"==typeof this._value},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"focused",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype.openDialog=function(){this.fileUpload&&this.fileUpload.nativeElement.click()},e.prototype.clearFiles=function(){this._value=[],this._files=[],this.recalculate()},e.prototype.removeFile=function(e){this._value.splice(this._value.indexOf(e.file),1),this._files.splice(this._files.indexOf(e),1),this.recalculate()},e.prototype.ngOnInit=function(){this.visibleValue=this.selectedText(this._files)},e.prototype.ngOnDestroy=function(){this.stateChanges.complete()},e.prototype.onChange=function(e){this._value=[],this._files=[];for(var t=0;t<e.length;t++)this._value.push(e[t]),this._files.push(new g(e[t]));this.recalculate()},e.prototype.writeValue=function(e){},e.prototype.registerOnChange=function(e){this._onChange=e},e.prototype.registerOnTouched=function(e){this.onTouched=e},e.prototype.setDisabledState=function(e){this.disabled=e},e.prototype.onContainerClick=function(){},e.prototype.focus=function(){},e.prototype.setDescribedByIds=function(){},e.prototype.recalculate=function(){this.fileUpload.nativeElement.value="",this.visibleValue=this.selectedText(this._files),this._onChange(this._value),this.onTouched(),this.updateErrorState()},e.decorators=[{type:n.Component,args:[{exportAs:"waMatFileUpload",selector:"wa-mat-file-upload",template:'<ng-template #previewContainer>\n\t<mat-list *ngIf="preview && files.length" [attr.dense]="dense ? \'dense\' : null">\n\t\t<ng-container *ngFor="let file of files; let isLast = last;">\n\t\t\t<mat-list-item>\n\t\t\t\t<img *ngIf="file.supportsImagePreview(); else listItemIcon" matListAvatar [src]="file.getImageSource() | async">\n\t\t\t\t<ng-template #listItemIcon>\n\t\t\t\t\t<mat-icon mat-list-icon>{{ file.icon }}</mat-icon>\n\t\t\t\t</ng-template>\n\n\t\t\t\t<h3 matLine>{{ file.file.name }}</h3>\n\n\t\t\t\t<mat-progress-bar *ngIf="file.progress" matLine mode="determinate" [value]="file.progress"></mat-progress-bar>\n\n\t\t\t\t<button *ngIf="!disabled && file.progress === 0" mat-icon-button (click)="removeFile(file)" type="button">\n\t\t\t\t\t<mat-icon>close</mat-icon>\n\t\t\t\t</button>\n\t\t\t</mat-list-item>\n\t\t\t<mat-divider *ngIf="!isLast"></mat-divider>\n\t\t</ng-container>\n\t</mat-list>\n</ng-template>\n\n<ng-container *ngIf="previewPosition === \'top\'">\n\t<ng-container *ngTemplateOutlet="previewContainer"></ng-container>\n</ng-container>\n\n<input #fileUpload type="file" (change)="onChange($event.target.files)" [multiple]="multiple" style="display: none;">\n\n<div>\n\t<button mat-raised-button (click)="openDialog()" [color]="color" [disabled]="disabled" type="button"><ng-content></ng-content></button>\n\t<span [ngClass]="{\'mat-caption\': dense}" style="padding-left: 10px;">\n\t\t{{ visibleValue }}\n\t\t<button *ngIf="!disabled && files.length" mat-icon-button (click)="clearFiles()" type="button">\n\t\t\t<mat-icon>close</mat-icon>\n\t\t</button>\n\t</span>\n</div>\n\n<ng-container *ngIf="previewPosition === \'bottom\'">\n\t<ng-container *ngTemplateOutlet="previewContainer"></ng-container>\n</ng-container>\n',providers:[{provide:l.MatFormFieldControl,useExisting:e}]}]}],e.ctorParameters=function(){return[{type:a.ErrorStateMatcher},{type:r.NgForm,decorators:[{type:n.Optional}]},{type:r.FormGroupDirective,decorators:[{type:n.Optional}]},{type:r.NgControl,decorators:[{type:n.Self},{type:n.Optional}]}]},e.propDecorators={placeholder:[{type:n.Input}],required:[{type:n.Input}],multiple:[{type:n.Input}],color:[{type:n.Input}],preview:[{type:n.Input}],previewPosition:[{type:n.Input}],dense:[{type:n.Input}],selectedText:[{type:n.Input}],fileUpload:[{type:n.ViewChild,args:["fileUpload"]}],value:[{type:n.Input}],disabled:[{type:n.Input}],id:[{type:n.Input}]},e}(y);function v(e){return 0===e.length?"":1===e.length?e[0].file.name:e.length+" Files selected"}var _=function(){function e(){}return e.decorators=[{type:n.NgModule,args:[{imports:[i.CommonModule,o.MatButtonModule,s.MatDividerModule,u.MatListModule,p.MatProgressBarModule,c.MatIconModule],declarations:[b],exports:[b],providers:[a.ErrorStateMatcher]}]}],e}();function I(r,o){return function(e){if(!e.value)return null;for(var t=e.value,n=[],i=0;i<t.length;i++)r(t[i])&&n.push(t[i]);return n.length?o(n):null}}e.MatFileUploadComponent=b,e.MatFileUploadModule=_,e.UploadFile=g,e.fileMaxSize=function C(t){return I(function(e){return e.size>t},function(e){return{fileMaxSize:{maxSize:t,invalidFiles:e}}})},e.fileType=function O(t){return I(function(e){return t.indexOf(e.type)<0},function(e){return{fileType:{allowedTypes:t,invalidFiles:e}}})},e.ɵa=h,e.ɵb=y,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=webacad-ng-mat-file-upload.umd.min.js.map