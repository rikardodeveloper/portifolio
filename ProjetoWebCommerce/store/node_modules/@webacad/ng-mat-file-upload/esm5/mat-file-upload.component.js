/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, Input, Optional, Self, ViewChild, ElementRef } from '@angular/core';
import { NgForm, FormGroupDirective, NgControl } from '@angular/forms';
import { ErrorStateMatcher, mixinErrorState } from '@angular/material/core';
import { MatFormFieldControl } from '@angular/material/form-field';
import { UploadFile } from './upload-file';
/** @type {?} */
var nextUniqueId = 0;
var BaseMatFileUploadComponent = /** @class */ (function () {
    function BaseMatFileUploadComponent(_defaultErrorStateMatcher, _parentForm, _parentFormGroup, ngControl) {
        this._defaultErrorStateMatcher = _defaultErrorStateMatcher;
        this._parentForm = _parentForm;
        this._parentFormGroup = _parentFormGroup;
        this.ngControl = ngControl;
    }
    return BaseMatFileUploadComponent;
}());
export { BaseMatFileUploadComponent };
if (false) {
    /** @type {?} */
    BaseMatFileUploadComponent.prototype._defaultErrorStateMatcher;
    /** @type {?} */
    BaseMatFileUploadComponent.prototype._parentForm;
    /** @type {?} */
    BaseMatFileUploadComponent.prototype._parentFormGroup;
    /** @type {?} */
    BaseMatFileUploadComponent.prototype.ngControl;
}
/** @type {?} */
export var _BaseMatFileUploadComponentMixin = mixinErrorState(BaseMatFileUploadComponent);
var MatFileUploadComponent = /** @class */ (function (_super) {
    tslib_1.__extends(MatFileUploadComponent, _super);
    function MatFileUploadComponent(defaultErrorStateMatcher, parentForm, parentFormGroup, ngControl) {
        var _this = _super.call(this, defaultErrorStateMatcher, parentForm, parentFormGroup, ngControl) || this;
        _this.ngControl = ngControl;
        _this.required = false;
        _this.multiple = false;
        _this.preview = false;
        _this.previewPosition = 'bottom';
        _this.dense = false;
        _this.selectedText = defaultSelectedText;
        _this.visibleValue = '';
        _this.shouldLabelFloat = true;
        _this._files = [];
        _this._uid = "wa-mat-file-upload-" + nextUniqueId++;
        _this.onTouched = function () { };
        _this._onChange = function (_) { };
        if (_this.ngControl !== null) {
            _this.ngControl.valueAccessor = _this;
        }
        return _this;
    }
    Object.defineProperty(MatFileUploadComponent.prototype, "value", {
        get: /**
         * @return {?}
         */
        function () {
            return this._value;
        },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) { },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MatFileUploadComponent.prototype, "disabled", {
        get: /**
         * @return {?}
         */
        function () {
            if (typeof this._disabled !== 'undefined') {
                return this._disabled;
            }
            if (this.ngControl && this.ngControl.disabled !== null) {
                return this.ngControl.disabled;
            }
            return false;
        },
        set: /**
         * @param {?} disabled
         * @return {?}
         */
        function (disabled) {
            this._disabled = disabled;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MatFileUploadComponent.prototype, "id", {
        get: /**
         * @return {?}
         */
        function () {
            return this._id;
        },
        set: /**
         * @param {?} id
         * @return {?}
         */
        function (id) {
            this._id = id || this._uid;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MatFileUploadComponent.prototype, "files", {
        get: /**
         * @return {?}
         */
        function () {
            return this._files;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MatFileUploadComponent.prototype, "empty", {
        get: /**
         * @return {?}
         */
        function () {
            return typeof this._value === 'undefined';
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MatFileUploadComponent.prototype, "focused", {
        get: /**
         * @return {?}
         */
        function () {
            return false;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    MatFileUploadComponent.prototype.openDialog = /**
     * @return {?}
     */
    function () {
        if (this.fileUpload) {
            this.fileUpload.nativeElement.click();
        }
    };
    /**
     * @return {?}
     */
    MatFileUploadComponent.prototype.clearFiles = /**
     * @return {?}
     */
    function () {
        this._value = [];
        this._files = [];
        this.recalculate();
    };
    /**
     * @param {?} file
     * @return {?}
     */
    MatFileUploadComponent.prototype.removeFile = /**
     * @param {?} file
     * @return {?}
     */
    function (file) {
        this._value.splice(this._value.indexOf(file.file), 1);
        this._files.splice(this._files.indexOf(file), 1);
        this.recalculate();
    };
    /**
     * @return {?}
     */
    MatFileUploadComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.visibleValue = this.selectedText(this._files);
    };
    /**
     * @return {?}
     */
    MatFileUploadComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        this.stateChanges.complete();
    };
    /**
     * @param {?} files
     * @return {?}
     */
    MatFileUploadComponent.prototype.onChange = /**
     * @param {?} files
     * @return {?}
     */
    function (files) {
        this._value = [];
        this._files = [];
        for (var i = 0; i < files.length; i++) {
            this._value.push(files[i]);
            this._files.push(new UploadFile(files[i]));
        }
        this.recalculate();
    };
    /**
     * @param {?} value
     * @return {?}
     */
    MatFileUploadComponent.prototype.writeValue = /**
     * @param {?} value
     * @return {?}
     */
    function (value) { };
    /**
     * @param {?} fn
     * @return {?}
     */
    MatFileUploadComponent.prototype.registerOnChange = /**
     * @param {?} fn
     * @return {?}
     */
    function (fn) {
        this._onChange = fn;
    };
    /**
     * @param {?} fn
     * @return {?}
     */
    MatFileUploadComponent.prototype.registerOnTouched = /**
     * @param {?} fn
     * @return {?}
     */
    function (fn) {
        this.onTouched = fn;
    };
    /**
     * @param {?} isDisabled
     * @return {?}
     */
    MatFileUploadComponent.prototype.setDisabledState = /**
     * @param {?} isDisabled
     * @return {?}
     */
    function (isDisabled) {
        this.disabled = isDisabled;
    };
    /**
     * @return {?}
     */
    MatFileUploadComponent.prototype.onContainerClick = /**
     * @return {?}
     */
    function () { };
    /**
     * @return {?}
     */
    MatFileUploadComponent.prototype.focus = /**
     * @return {?}
     */
    function () { };
    /**
     * @return {?}
     */
    MatFileUploadComponent.prototype.setDescribedByIds = /**
     * @return {?}
     */
    function () { };
    /**
     * @return {?}
     */
    MatFileUploadComponent.prototype.recalculate = /**
     * @return {?}
     */
    function () {
        this.fileUpload.nativeElement.value = '';
        this.visibleValue = this.selectedText(this._files);
        this._onChange(this._value);
        this.onTouched();
        this.updateErrorState();
    };
    MatFileUploadComponent.decorators = [
        { type: Component, args: [{
                    exportAs: 'waMatFileUpload',
                    selector: 'wa-mat-file-upload',
                    template: "<ng-template #previewContainer>\n\t<mat-list *ngIf=\"preview && files.length\" [attr.dense]=\"dense ? 'dense' : null\">\n\t\t<ng-container *ngFor=\"let file of files; let isLast = last;\">\n\t\t\t<mat-list-item>\n\t\t\t\t<img *ngIf=\"file.supportsImagePreview(); else listItemIcon\" matListAvatar [src]=\"file.getImageSource() | async\">\n\t\t\t\t<ng-template #listItemIcon>\n\t\t\t\t\t<mat-icon mat-list-icon>{{ file.icon }}</mat-icon>\n\t\t\t\t</ng-template>\n\n\t\t\t\t<h3 matLine>{{ file.file.name }}</h3>\n\n\t\t\t\t<mat-progress-bar *ngIf=\"file.progress\" matLine mode=\"determinate\" [value]=\"file.progress\"></mat-progress-bar>\n\n\t\t\t\t<button *ngIf=\"!disabled && file.progress === 0\" mat-icon-button (click)=\"removeFile(file)\" type=\"button\">\n\t\t\t\t\t<mat-icon>close</mat-icon>\n\t\t\t\t</button>\n\t\t\t</mat-list-item>\n\t\t\t<mat-divider *ngIf=\"!isLast\"></mat-divider>\n\t\t</ng-container>\n\t</mat-list>\n</ng-template>\n\n<ng-container *ngIf=\"previewPosition === 'top'\">\n\t<ng-container *ngTemplateOutlet=\"previewContainer\"></ng-container>\n</ng-container>\n\n<input #fileUpload type=\"file\" (change)=\"onChange($event.target.files)\" [multiple]=\"multiple\" style=\"display: none;\">\n\n<div>\n\t<button mat-raised-button (click)=\"openDialog()\" [color]=\"color\" [disabled]=\"disabled\" type=\"button\"><ng-content></ng-content></button>\n\t<span [ngClass]=\"{'mat-caption': dense}\" style=\"padding-left: 10px;\">\n\t\t{{ visibleValue }}\n\t\t<button *ngIf=\"!disabled && files.length\" mat-icon-button (click)=\"clearFiles()\" type=\"button\">\n\t\t\t<mat-icon>close</mat-icon>\n\t\t</button>\n\t</span>\n</div>\n\n<ng-container *ngIf=\"previewPosition === 'bottom'\">\n\t<ng-container *ngTemplateOutlet=\"previewContainer\"></ng-container>\n</ng-container>\n",
                    providers: [
                        {
                            provide: MatFormFieldControl,
                            useExisting: MatFileUploadComponent,
                        },
                    ]
                }] }
    ];
    /** @nocollapse */
    MatFileUploadComponent.ctorParameters = function () { return [
        { type: ErrorStateMatcher },
        { type: NgForm, decorators: [{ type: Optional }] },
        { type: FormGroupDirective, decorators: [{ type: Optional }] },
        { type: NgControl, decorators: [{ type: Self }, { type: Optional }] }
    ]; };
    MatFileUploadComponent.propDecorators = {
        placeholder: [{ type: Input }],
        required: [{ type: Input }],
        multiple: [{ type: Input }],
        color: [{ type: Input }],
        preview: [{ type: Input }],
        previewPosition: [{ type: Input }],
        dense: [{ type: Input }],
        selectedText: [{ type: Input }],
        fileUpload: [{ type: ViewChild, args: ['fileUpload',] }],
        value: [{ type: Input }],
        disabled: [{ type: Input }],
        id: [{ type: Input }]
    };
    return MatFileUploadComponent;
}(_BaseMatFileUploadComponentMixin));
export { MatFileUploadComponent };
if (false) {
    /** @type {?} */
    MatFileUploadComponent.prototype.placeholder;
    /** @type {?} */
    MatFileUploadComponent.prototype.required;
    /** @type {?} */
    MatFileUploadComponent.prototype.multiple;
    /** @type {?} */
    MatFileUploadComponent.prototype.color;
    /** @type {?} */
    MatFileUploadComponent.prototype.preview;
    /** @type {?} */
    MatFileUploadComponent.prototype.previewPosition;
    /** @type {?} */
    MatFileUploadComponent.prototype.dense;
    /** @type {?} */
    MatFileUploadComponent.prototype.selectedText;
    /** @type {?} */
    MatFileUploadComponent.prototype.fileUpload;
    /** @type {?} */
    MatFileUploadComponent.prototype.visibleValue;
    /** @type {?} */
    MatFileUploadComponent.prototype.shouldLabelFloat;
    /** @type {?} */
    MatFileUploadComponent.prototype._value;
    /** @type {?} */
    MatFileUploadComponent.prototype._files;
    /** @type {?} */
    MatFileUploadComponent.prototype._disabled;
    /** @type {?} */
    MatFileUploadComponent.prototype._id;
    /** @type {?} */
    MatFileUploadComponent.prototype._uid;
    /** @type {?} */
    MatFileUploadComponent.prototype.onTouched;
    /** @type {?} */
    MatFileUploadComponent.prototype._onChange;
    /** @type {?} */
    MatFileUploadComponent.prototype.ngControl;
}
/**
 * @param {?} files
 * @return {?}
 */
function defaultSelectedText(files) {
    if (files.length === 0) {
        return '';
    }
    if (files.length === 1) {
        return files[0].file.name;
    }
    return files.length + ' Files selected';
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWF0LWZpbGUtdXBsb2FkLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0B3ZWJhY2FkL25nLW1hdC1maWxlLXVwbG9hZC8iLCJzb3VyY2VzIjpbIm1hdC1maWxlLXVwbG9hZC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUMsU0FBUyxFQUFFLEtBQUssRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFxQixTQUFTLEVBQUUsVUFBVSxFQUFDLE1BQU0sZUFBZSxDQUFDO0FBQ3pHLE9BQU8sRUFBdUIsTUFBTSxFQUFFLGtCQUFrQixFQUFFLFNBQVMsRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBQzNGLE9BQU8sRUFBQyxpQkFBaUIsRUFBdUIsZUFBZSxFQUFDLE1BQU0sd0JBQXdCLENBQUM7QUFDL0YsT0FBTyxFQUFDLG1CQUFtQixFQUFDLE1BQU0sOEJBQThCLENBQUM7QUFFakUsT0FBTyxFQUFDLFVBQVUsRUFBQyxNQUFNLGVBQWUsQ0FBQzs7QUFHekMsSUFBSSxZQUFZLEdBQVcsQ0FBQyxDQUFDO0FBRzdCLElBQUE7SUFJQyxvQ0FDUSwyQkFDQSxhQUNBLGtCQUNBO1FBSEEsOEJBQXlCLEdBQXpCLHlCQUF5QjtRQUN6QixnQkFBVyxHQUFYLFdBQVc7UUFDWCxxQkFBZ0IsR0FBaEIsZ0JBQWdCO1FBQ2hCLGNBQVMsR0FBVCxTQUFTO0tBQ2I7cUNBcEJMO0lBc0JDLENBQUE7QUFYRCxzQ0FXQzs7Ozs7Ozs7Ozs7O0FBR0QsV0FBYSxnQ0FBZ0MsR0FBRyxlQUFlLENBQUMsMEJBQTBCLENBQUMsQ0FBQzs7SUFjaEQsa0RBQWdDO0lBa0QzRSxnQ0FDQyx3QkFBMkMsRUFDL0IsVUFBa0IsRUFDbEIsZUFBbUMsRUFDWCxTQUFvQjtRQUp6RCxZQU1DLGtCQUFNLHdCQUF3QixFQUFFLFVBQVUsRUFBRSxlQUFlLEVBQUUsU0FBUyxDQUFDLFNBS3ZFO1FBUG9DLGVBQVMsR0FBVCxTQUFTLENBQVc7eUJBMUM5QixLQUFL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QW1COzRCQUM1QixXQUFXLEVBQUUsc0JBQXNCO3lCQUNuQztxQkFDRDtpQkFDRDs7OztnQkFwQ08saUJBQWlCO2dCQURLLE1BQU0sdUJBMEZqQyxRQUFRO2dCQTFGMkIsa0JBQWtCLHVCQTJGckQsUUFBUTtnQkEzRitDLFNBQVMsdUJBNEZoRSxJQUFJLFlBQUksUUFBUTs7OzhCQTlDakIsS0FBSzsyQkFHTCxLQUFLOzJCQUdMLEtBQUs7d0JBR0wsS0FBSzswQkFHTCxLQUFLO2tDQUdMLEtBQUs7d0JBR0wsS0FBSzsrQkFHTCxLQUFLOzZCQUdMLFNBQVMsU0FBQyxZQUFZO3dCQWdDdEIsS0FBSzsyQkFTTCxLQUFLO3FCQW9CTCxLQUFLOztpQ0FwSVA7RUF1QzRDLGdDQUFnQztTQUEvRCxzQkFBc0I7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQThObkMsNkJBQTZCLEtBQXdCO0lBRXBELElBQUksS0FBSyxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUU7UUFDdkIsT0FBTyxFQUFFLENBQUM7S0FDVjtJQUVELElBQUksS0FBSyxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUU7UUFDdkIsT0FBTyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQztLQUMxQjtJQUVELE9BQU8sS0FBSyxDQUFDLE1BQU0sR0FBRyxpQkFBaUIsQ0FBQztDQUN4QyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7Q29tcG9uZW50LCBJbnB1dCwgT3B0aW9uYWwsIFNlbGYsIE9uSW5pdCwgT25EZXN0cm95LCBWaWV3Q2hpbGQsIEVsZW1lbnRSZWZ9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHtDb250cm9sVmFsdWVBY2Nlc3NvciwgTmdGb3JtLCBGb3JtR3JvdXBEaXJlY3RpdmUsIE5nQ29udHJvbH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xuaW1wb3J0IHtFcnJvclN0YXRlTWF0Y2hlciwgQ2FuVXBkYXRlRXJyb3JTdGF0ZSwgbWl4aW5FcnJvclN0YXRlfSBmcm9tICdAYW5ndWxhci9tYXRlcmlhbC9jb3JlJztcbmltcG9ydCB7TWF0Rm9ybUZpZWxkQ29udHJvbH0gZnJvbSAnQGFuZ3VsYXIvbWF0ZXJpYWwvZm9ybS1maWVsZCc7XG5cbmltcG9ydCB7VXBsb2FkRmlsZX0gZnJvbSAnLi91cGxvYWQtZmlsZSc7XG5cblxubGV0IG5leHRVbmlxdWVJZDogbnVtYmVyID0gMDtcblxuXG5leHBvcnQgY2xhc3MgQmFzZU1hdEZpbGVVcGxvYWRDb21wb25lbnRcbntcblxuXG5cdGNvbnN0cnVjdG9yKFxuXHRcdHB1YmxpYyBfZGVmYXVsdEVycm9yU3RhdGVNYXRjaGVyOiBFcnJvclN0YXRlTWF0Y2hlcixcblx0XHRwdWJsaWMgX3BhcmVudEZvcm06IE5nRm9ybSxcblx0XHRwdWJsaWMgX3BhcmVudEZvcm1Hcm91cDogRm9ybUdyb3VwRGlyZWN0aXZlLFxuXHRcdHB1YmxpYyBuZ0NvbnRyb2w6IE5nQ29udHJvbCxcblx0KSB7fVxuXG59XG5cblxuZXhwb3J0IGNvbnN0IF9CYXNlTWF0RmlsZVVwbG9hZENvbXBvbmVudE1peGluID0gbWl4aW5FcnJvclN0YXRlKEJhc2VNYXRGaWxlVXBsb2FkQ29tcG9uZW50KTtcblxuXG5AQ29tcG9uZW50KHtcblx0ZXhwb3J0QXM6ICd3YU1hdEZpbGVVcGxvYWQnLFxuXHRzZWxlY3RvcjogJ3dhLW1hdC1maWxlLXVwbG9hZCcsXG5cdHRlbXBsYXRlVXJsOiAnLi9tYXQtZmlsZS11cGxvYWQuY29tcG9uZW50Lmh0bWwnLFxuXHRwcm92aWRlcnM6IFtcblx0XHR7XG5cdFx0XHRwcm92aWRlOiBNYXRGb3JtRmllbGRDb250cm9sLFxuXHRcdFx0dXNlRXhpc3Rpbmc6IE1hdEZpbGVVcGxvYWRDb21wb25lbnQsXG5cdFx0fSxcblx0XSxcbn0pXG5leHBvcnQgY2xhc3MgTWF0RmlsZVVwbG9hZENvbXBvbmVudCBleHRlbmRzIF9CYXNlTWF0RmlsZVVwbG9hZENvbXBvbmVudE1peGluIGltcGxlbWVudHNcblx0T25Jbml0LFxuXHRPbkRlc3Ryb3ksXG5cdENvbnRyb2xWYWx1ZUFjY2Vzc29yLFxuXHRNYXRGb3JtRmllbGRDb250cm9sPEFycmF5PEZpbGU+Plxue1xuXG5cblx0QElucHV0KClcblx0cHVibGljIHBsYWNlaG9sZGVyOiBzdHJpbmc7XG5cblx0QElucHV0KClcblx0cHVibGljIHJlcXVpcmVkOiBib29sZWFuID0gZmFsc2U7XG5cblx0QElucHV0KClcblx0cHVibGljIG11bHRpcGxlOiBib29sZWFuID0gZmFsc2U7XG5cblx0QElucHV0KClcblx0cHVibGljIGNvbG9yOiBzdHJpbmd8dW5kZWZpbmVkO1xuXG5cdEBJbnB1dCgpXG5cdHB1YmxpYyBwcmV2aWV3OiBib29sZWFuID0gZmFsc2U7XG5cblx0QElucHV0KClcblx0cHVibGljIHByZXZpZXdQb3NpdGlvbjogJ3RvcCcgfCAnYm90dG9tJyA9ICdib3R0b20nO1xuXG5cdEBJbnB1dCgpXG5cdHB1YmxpYyBkZW5zZTogYm9vbGVhbiA9IGZhbHNlO1xuXG5cdEBJbnB1dCgpXG5cdHB1YmxpYyBzZWxlY3RlZFRleHQ6IChmaWxlczogQXJyYXk8VXBsb2FkRmlsZT4pID0+IHN0cmluZyA9IGRlZmF1bHRTZWxlY3RlZFRleHQ7XG5cblx0QFZpZXdDaGlsZCgnZmlsZVVwbG9hZCcpXG5cdHB1YmxpYyBmaWxlVXBsb2FkOiBFbGVtZW50UmVmO1xuXG5cdHB1YmxpYyB2aXNpYmxlVmFsdWU6IHN0cmluZyA9ICcnO1xuXG5cdHB1YmxpYyBzaG91bGRMYWJlbEZsb2F0OiBib29sZWFuID0gdHJ1ZTtcblxuXHRwcml2YXRlIF92YWx1ZTogQXJyYXk8RmlsZT47XG5cblx0cHJpdmF0ZSBfZmlsZXM6IEFycmF5PFVwbG9hZEZpbGU+ID0gW107XG5cblx0cHJpdmF0ZSBfZGlzYWJsZWQ6IGJvb2xlYW47XG5cblx0cHJpdmF0ZSBfaWQ6IHN0cmluZztcblxuXHRwcml2YXRlIF91aWQ6IHN0cmluZyA9IGB3YS1tYXQtZmlsZS11cGxvYWQtJHtuZXh0VW5pcXVlSWQrK31gO1xuXG5cblx0Y29uc3RydWN0b3IoXG5cdFx0ZGVmYXVsdEVycm9yU3RhdGVNYXRjaGVyOiBFcnJvclN0YXRlTWF0Y2hlcixcblx0XHRAT3B0aW9uYWwoKSBwYXJlbnRGb3JtOiBOZ0Zvcm0sXG5cdFx0QE9wdGlvbmFsKCkgcGFyZW50Rm9ybUdyb3VwOiBGb3JtR3JvdXBEaXJlY3RpdmUsXG5cdFx0QFNlbGYoKSBAT3B0aW9uYWwoKSBwdWJsaWMgcmVhZG9ubHkgbmdDb250cm9sOiBOZ0NvbnRyb2wsXG5cdCkge1xuXHRcdHN1cGVyKGRlZmF1bHRFcnJvclN0YXRlTWF0Y2hlciwgcGFyZW50Rm9ybSwgcGFyZW50Rm9ybUdyb3VwLCBuZ0NvbnRyb2wpO1xuXG5cdFx0aWYgKHRoaXMubmdDb250cm9sICE9PSBudWxsKSB7XG5cdFx0XHR0aGlzLm5nQ29udHJvbC52YWx1ZUFjY2Vzc29yID0gdGhpcztcblx0XHR9XG5cdH1cblxuXG5cdEBJbnB1dCgpXG5cdGdldCB2YWx1ZSgpOiBBcnJheTxGaWxlPlxuXHR7XG5cdFx0cmV0dXJuIHRoaXMuX3ZhbHVlO1xuXHR9XG5cblx0c2V0IHZhbHVlKHZhbHVlOiBBcnJheTxGaWxlPikge31cblxuXG5cdEBJbnB1dCgpXG5cdGdldCBkaXNhYmxlZCgpOiBib29sZWFuXG5cdHtcblx0XHRpZiAodHlwZW9mIHRoaXMuX2Rpc2FibGVkICE9PSAndW5kZWZpbmVkJykge1xuXHRcdFx0cmV0dXJuIHRoaXMuX2Rpc2FibGVkO1xuXHRcdH1cblxuXHRcdGlmICh0aGlzLm5nQ29udHJvbCAmJiB0aGlzLm5nQ29udHJvbC5kaXNhYmxlZCAhPT0gbnVsbCkge1xuXHRcdFx0cmV0dXJuIHRoaXMubmdDb250cm9sLmRpc2FibGVkO1xuXHRcdH1cblxuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXG5cdHNldCBkaXNhYmxlZChkaXNhYmxlZDogYm9vbGVhbilcblx0e1xuXHRcdHRoaXMuX2Rpc2FibGVkID0gZGlzYWJsZWQ7XG5cdH1cblxuXG5cdEBJbnB1dCgpXG5cdGdldCBpZCgpOiBzdHJpbmdcblx0e1xuXHRcdHJldHVybiB0aGlzLl9pZDtcblx0fVxuXG5cdHNldCBpZChpZDogc3RyaW5nKVxuXHR7XG5cdFx0dGhpcy5faWQgPSBpZCB8fCB0aGlzLl91aWQ7XG5cdH1cblxuXG5cdGdldCBmaWxlcygpOiBBcnJheTxVcGxvYWRGaWxlPlxuXHR7XG5cdFx0cmV0dXJuIHRoaXMuX2ZpbGVzO1xuXHR9XG5cblxuXHRnZXQgZW1wdHkoKTogYm9vbGVhblxuXHR7XG5cdFx0cmV0dXJuIHR5cGVvZiB0aGlzLl92YWx1ZSA9PT0gJ3VuZGVmaW5lZCc7XG5cdH1cblxuXG5cdGdldCBmb2N1c2VkKCk6IGJvb2xlYW5cblx0e1xuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXG5cblx0cHVibGljIG9wZW5EaWFsb2coKTogdm9pZFxuXHR7XG5cdFx0aWYgKHRoaXMuZmlsZVVwbG9hZCkge1xuXHRcdFx0dGhpcy5maWxlVXBsb2FkLm5hdGl2ZUVsZW1lbnQuY2xpY2soKTtcblx0XHR9XG5cdH1cblxuXG5cdHB1YmxpYyBjbGVhckZpbGVzKCk6IHZvaWRcblx0e1xuXHRcdHRoaXMuX3ZhbHVlID0gW107XG5cdFx0dGhpcy5fZmlsZXMgPSBbXTtcblx0XHR0aGlzLnJlY2FsY3VsYXRlKCk7XG5cdH1cblxuXG5cdHB1YmxpYyByZW1vdmVGaWxlKGZpbGU6IFVwbG9hZEZpbGUpOiB2b2lkXG5cdHtcblx0XHR0aGlzLl92YWx1ZS5zcGxpY2UodGhpcy5fdmFsdWUuaW5kZXhPZihmaWxlLmZpbGUpLCAxKTtcblx0XHR0aGlzLl9maWxlcy5zcGxpY2UodGhpcy5fZmlsZXMuaW5kZXhPZihmaWxlKSwgMSk7XG5cdFx0dGhpcy5yZWNhbGN1bGF0ZSgpO1xuXHR9XG5cblxuXHRwdWJsaWMgbmdPbkluaXQoKTogdm9pZFxuXHR7XG5cdFx0dGhpcy52aXNpYmxlVmFsdWUgPSB0aGlzLnNlbGVjdGVkVGV4dCh0aGlzLl9maWxlcyk7XG5cdH1cblxuXG5cdHB1YmxpYyBuZ09uRGVzdHJveSgpOiB2b2lkXG5cdHtcblx0XHR0aGlzLnN0YXRlQ2hhbmdlcy5jb21wbGV0ZSgpO1xuXHR9XG5cblxuXHRwdWJsaWMgb25Ub3VjaGVkID0gKCkgPT4ge307XG5cblxuXHRwdWJsaWMgb25DaGFuZ2UoZmlsZXM6IEZpbGVMaXN0KTogdm9pZFxuXHR7XG5cdFx0dGhpcy5fdmFsdWUgPSBbXTtcblx0XHR0aGlzLl9maWxlcyA9IFtdO1xuXG5cdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBmaWxlcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0dGhpcy5fdmFsdWUucHVzaChmaWxlc1tpXSk7XG5cdFx0XHR0aGlzLl9maWxlcy5wdXNoKG5ldyBVcGxvYWRGaWxlKGZpbGVzW2ldKSk7XG5cdFx0fVxuXG5cdFx0dGhpcy5yZWNhbGN1bGF0ZSgpO1xuXHR9XG5cblxuXHRwdWJsaWMgd3JpdGVWYWx1ZSh2YWx1ZTogYW55KTogdm9pZCB7fVxuXG5cblx0cHVibGljIHJlZ2lzdGVyT25DaGFuZ2UoZm46IChfOiBhbnkpID0+IHZvaWQpOiB2b2lkXG5cdHtcblx0XHR0aGlzLl9vbkNoYW5nZSA9IGZuO1xuXHR9XG5cblxuXHRwdWJsaWMgcmVnaXN0ZXJPblRvdWNoZWQoZm46ICgpID0+IHZvaWQpOiB2b2lkXG5cdHtcblx0XHR0aGlzLm9uVG91Y2hlZCA9IGZuO1xuXHR9XG5cblxuXHRwdWJsaWMgc2V0RGlzYWJsZWRTdGF0ZShpc0Rpc2FibGVkOiBib29sZWFuKTogdm9pZFxuXHR7XG5cdFx0dGhpcy5kaXNhYmxlZCA9IGlzRGlzYWJsZWQ7XG5cdH1cblxuXG5cdHB1YmxpYyBvbkNvbnRhaW5lckNsaWNrKCk6IHZvaWQge31cblxuXG5cdHB1YmxpYyBmb2N1cygpOiB2b2lkIHt9XG5cblxuXHRwdWJsaWMgc2V0RGVzY3JpYmVkQnlJZHMoKTogdm9pZCB7fVxuXG5cblx0cHJpdmF0ZSBfb25DaGFuZ2UgPSAoXzogYW55KSA9PiB7fTtcblxuXG5cdHByaXZhdGUgcmVjYWxjdWxhdGUoKTogdm9pZFxuXHR7XG5cdFx0dGhpcy5maWxlVXBsb2FkLm5hdGl2ZUVsZW1lbnQudmFsdWUgPSAnJztcblx0XHR0aGlzLnZpc2libGVWYWx1ZSA9IHRoaXMuc2VsZWN0ZWRUZXh0KHRoaXMuX2ZpbGVzKTtcblxuXHRcdHRoaXMuX29uQ2hhbmdlKHRoaXMuX3ZhbHVlKTtcblx0XHR0aGlzLm9uVG91Y2hlZCgpO1xuXHRcdHRoaXMudXBkYXRlRXJyb3JTdGF0ZSgpO1xuXHR9XG5cbn1cblxuXG5mdW5jdGlvbiBkZWZhdWx0U2VsZWN0ZWRUZXh0KGZpbGVzOiBBcnJheTxVcGxvYWRGaWxlPik6IHN0cmluZ1xue1xuXHRpZiAoZmlsZXMubGVuZ3RoID09PSAwKSB7XG5cdFx0cmV0dXJuICcnO1xuXHR9XG5cblx0aWYgKGZpbGVzLmxlbmd0aCA9PT0gMSkge1xuXHRcdHJldHVybiBmaWxlc1swXS5maWxlLm5hbWU7XG5cdH1cblxuXHRyZXR1cm4gZmlsZXMubGVuZ3RoICsgJyBGaWxlcyBzZWxlY3RlZCc7XG59XG4iXX0=